<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dante‚Äôs Fun Hub üéâ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background:
        radial-gradient(circle at center, #2a003d, #0f0014);
      color: #eee;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      justify-content: center;
      min-height: 100vh;
      padding: 1rem;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    #app-container {
      max-width: 480px;
      width: 100%;
      background: linear-gradient(145deg, #3b0050, #210027);
      border-radius: 16px;
      box-shadow: 0 0 25px #a45fff88;
      padding: 1.5rem 1rem 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }

    header h1 {
      font-weight: 900;
      font-size: 2.5rem;
      text-align: center;
      color: #ff7fff;
      text-shadow:
        0 0 8px #ff7fff99,
        0 0 12px #f400d1bb;
      margin-bottom: 0.3rem;
    }

    header p {
      font-weight: 600;
      font-size: 1.1rem;
      text-align: center;
      color: #dda3ffcc;
      margin-bottom: 1.5rem;
      user-select: text;
    }

    #button-container {
      width: 100%;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 12px;
      margin-bottom: 1rem;
    }

    button[data-category] {
      background: #6e00af;
      border: none;
      border-radius: 12px;
      padding: 1rem 0.5rem;
      font-weight: 700;
      font-size: 1rem;
      color: #fff;
      cursor: pointer;
      box-shadow:
        0 0 5px #ff56ffaa,
        0 0 15px #bb33ccaa;
      transition:
        background-color 0.3s ease,
        box-shadow 0.4s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      user-select: none;
    }

    button[data-category]:hover,
    button[data-category]:focus {
      background: #b034ff;
      box-shadow:
        0 0 10px #ff8affee,
        0 0 25px #d362ffcc;
      outline: none;
    }

    /* Popup overlay */
    #popup-overlay {
      display: none;
      position: fixed;
      z-index: 1000;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(30, 0, 60, 0.85);
      backdrop-filter: blur(8px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      overflow-y: auto;
    }

    #popup-content {
      background: linear-gradient(135deg, #440066, #220033);
      border-radius: 16px;
      box-shadow: 0 0 30px #ff66ffcc;
      max-width: 400px;
      width: 100%;
      padding: 1.5rem 1.3rem 2rem;
      color: #ffd9ff;
      font-size: 1.1rem;
      line-height: 1.5;
      position: relative;
      user-select: text;
      text-align: center;
      font-weight: 600;
      text-shadow:
        0 0 3px #ff8affaa;
      min-height: 160px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    #popup-content h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.7rem;
      color: #ff8aff;
      text-shadow:
        0 0 15px #ff8affcc,
        0 0 40px #ff00ffc9;
    }

    #popup-content p {
      margin-bottom: 1rem;
      font-weight: 600;
    }

    #popup-content .popup-buttons {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
    }

    #popup-content button {
      background: #9b1fff;
      border: none;
      border-radius: 12px;
      padding: 0.7rem 1.2rem;
      font-weight: 700;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      box-shadow:
        0 0 8px #ff56ffcc,
        0 0 15px #bb33ccdd;
      user-select: none;
      transition:
        background-color 0.25s ease,
        box-shadow 0.3s ease;
    }

    #popup-content button:disabled {
      background: #4b0040;
      box-shadow: none;
      cursor: not-allowed;
      color: #bbb;
    }

    #popup-content button:hover:not(:disabled),
    #popup-content button:focus:not(:disabled) {
      background: #d459ff;
      box-shadow:
        0 0 15px #ff99ffdd,
        0 0 30px #e07bffdd;
      outline: none;
    }

    #close-popup {
      position: fixed;
      top: 12px;
      right: 12px;
      background: transparent;
      border: none;
      font-size: 2rem;
      color: #ff66ffcc;
      cursor: pointer;
      text-shadow:
        0 0 5px #ff66ffcc;
      user-select: none;
      transition: color 0.3s ease;
      z-index: 1100;
    }
    #close-popup:hover,
    #close-popup:focus {
      color: #ff00ff;
      outline: none;
      text-shadow:
        0 0 12px #ff00ffdd,
        0 0 30px #ff00ffdd;
    }

    /* Scrollbar for popup if needed */
    #popup-overlay::-webkit-scrollbar {
      width: 8px;
    }
    #popup-overlay::-webkit-scrollbar-thumb {
      background: #7f0099cc;
      border-radius: 10px;
    }

    /* Mini game canvas styling */
    #mini-game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      user-select: none;
    }

    #game-canvas {
      background: #33004d;
      border: 3px solid #bb33cc;
      border-radius: 12px;
      box-shadow:
        0 0 15px #d362ffcc;
      width: 100%;
      max-width: 380px;
      aspect-ratio: 4 / 3;
      display: block;
      margin: 0 auto;
    }

    #game-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
    }

    #game-controls button {
      background: #9b1fff;
      border: none;
      border-radius: 12px;
      padding: 0.5rem 1rem;
      font-weight: 700;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      box-shadow:
        0 0 8px #ff56ffcc,
        0 0 15px #bb33ccdd;
      user-select: none;
      transition:
        background-color 0.25s ease,
        box-shadow 0.3s ease;
    }

    #game-controls button:hover,
    #game-controls button:focus {
      background: #d459ff;
      box-shadow:
        0 0 15px #ff99ffdd,
        0 0 30px #e07bffdd;
      outline: none;
    }

    /* DanteBot Chat UI */
    #dantebot-container {
      display: flex;
      flex-direction: column;
      max-width: 380px;
      margin: 0 auto;
      gap: 10px;
      color: #eee;
      font-weight: 600;
      user-select: text;
    }
    #dantebot-log {
      background: #220022dd;
      border-radius: 12px;
      padding: 1rem;
      height: 180px;
      overflow-y: auto;
      font-size: 0.95rem;
      box-shadow: inset 0 0 10px #a142f5cc;
    }
    #dantebot-input-container {
      display: flex;
      gap: 8px;
    }
    #dantebot-input {
      flex-grow: 1;
      border-radius: 12px;
      border: none;
      padding: 0.6rem 1rem;
      font-size: 1rem;
      font-family: 'Montserrat', sans-serif;
      background: #440066dd;
      color: #eee;
      box-shadow:
        0 0 8px #d460ffcc;
      outline: none;
      user-select: text;
    }
    #dantebot-input::placeholder {
      color: #bb99ffcc;
    }
    #dantebot-send {
      background: #bb33cc;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-weight: 700;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      cursor: pointer;
      box-shadow:
        0 0 8px #ff56ffcc,
        0 0 15px #bb33ccdd;
      user-select: none;
      transition: background-color 0.25s ease;
    }
    #dantebot-send:hover,
    #dantebot-send:focus {
      background: #e055ff;
      box-shadow:
        0 0 15px #ff99ffdd,
        0 0 30px #e07bffdd;
      outline: none;
    }

    /* Responsive tweaks */
    @media (max-width: 400px) {
      header h1 {
        font-size: 2rem;
      }
      button[data-category] {
        font-size: 0.9rem;
        padding: 0.75rem 0.5rem;
      }
      #popup-content {
        font-size: 1rem;
        max-width: 90vw;
      }
    }
  </style>
</head>
<body>
  <div id="app-container" role="main">
    <header>
      <h1>Dante‚Äôs Fun Hub üéâ</h1>
      <p>Welcome to your personalized fun zone! Pick a category below.</p>
    </header>
    <main>
      <div id="button-container" role="list">
        <button data-category="funnyFacts" aria-label="Funny Facts" role="listitem">üòÇ Funny Facts</button>
        <button data-category="dailyChallenges" aria-label="Daily Challenges" role="listitem">üèÜ Daily Challenges</button>
        <button data-category="snackIdeas" aria-label="Snack Ideas" role="listitem">üçø Snack Ideas</button>
        <button data-category="jokes" aria-label="Jokes" role="listitem">ü§£ Jokes</button>
        <button data-category="zeusCorner" aria-label="Zeus‚Äôs Corner" role="listitem">üê∂ Zeus‚Äôs Corner</button>
        <button data-category="miniGames" aria-label="Mini Games" role="listitem">üéÆ Mini Games</button>
        <button data-category="danteBot" aria-label="Chat with DanteBot" role="listitem">ü§ñ DanteBot</button>
      </div>
    </main>
  </div>

  <!-- Popup Overlay -->
  <div id="popup-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Popup content">
    <div id="popup-content" tabindex="0"></div>
    <button id="close-popup" aria-label="Close popup" title="Close popup">‚úñ</button>
  </div>

  <script>
    (() => {
      // Content data
      const data = {
        funnyFacts: [
          "Lobsters can live up to 100 years and grow new limbs if they lose them!",
          "Dante‚Äôs dog Zeus once scared a raccoon away just by barking twice.",
          "The first rap song recorded was in 1979 ‚Äî ‚ÄúRapper‚Äôs Delight‚Äù by the Sugarhill Gang.",
          "Sassy the Sasquatch is known for her wild antics and savage burns!",
          "Trailer Park Boys‚Äô Bubbles has over 200 pairs of glasses.",
          "Lobster shells are soft when they hatch, making baby lobsters vulnerable to predators.",
          "Cars can lose up to 15% fuel efficiency if tires are under-inflated.",
          "The Mi‚Äôkmaq language has unique words for different types of snow and ice.",
          "Raves originally started as underground parties in the late 80s and 90s.",
          "Zeus loves snacks but has a favorite ‚Äî peanut butter treats!"
        ],
        dailyChallenges: [
          "Fix something small around the house or workshop today.",
          "Try a new snack or food item you‚Äôve never had before.",
          "Take Zeus for an extra-long walk and enjoy the fresh air.",
          "Write a short funny story inspired by Trailer Park Boys or Sassy the Sasquatch.",
          "Find a new rap song to add to your playlist.",
          "Build or tinker with something mechanical or electronic for 30 minutes.",
          "Learn 3 words in Mi‚Äôkmaq and try to use them in a sentence.",
          "Plan your next rave or festival outfit ‚Äî get creative!",
          "Practice deep breathing or a quick grounding exercise for focus.",
          "Tell a friend or me a joke that made you laugh recently."
        ],
        snackIdeas: [
          "Chili lime popcorn with a dash of cayenne pepper.",
          "Peanut butter and honey sandwich on toasted rye.",
          "Sweet potato fries with garlic aioli.",
          "Frozen grapes dipped in dark chocolate.",
          "Homemade trail mix with nuts, dried fruit, and M&Ms.",
          "Spicy hummus with crunchy carrot sticks.",
          "Zeus‚Äôs favorite peanut butter treats (for sharing!).",
          "Cold brew coffee with a splash of vanilla almond milk.",
          "Microwave nachos with melted cheese and jalape√±os.",
          "Banana and almond butter rolled in granola."
        ],
        jokes: [
          "Why don‚Äôt lobsters share their food? Because they‚Äôre shellfish!",
          "What‚Äôs a mechanic‚Äôs favorite type of music? Heavy metal!",
          "Why did the rap artist go to school? To improve his flow!",
          "How does Sassy the Sasquatch make a party? With some wild footwork!",
          "Why don‚Äôt Trailer Park Boys ever get lost? Because Bubbles is their GPS!",
          "What did the car say to the mechanic? 'I‚Äôm exhausted!'",
          "Why did Zeus the dog sit in the shade? Because he didn‚Äôt want to be a hot dog!",
          "What do you call a rapper who fixes cars? A rapairman!",
          "Why was the rave so bright? Because the neon lights were lit!",
          "What‚Äôs an engineer‚Äôs favorite drink? A Screwdriver!"
        ],
        zeusCorner: [
          "Zeus loves belly rubs and will do a happy dance for peanut butter treats.",
          "Did you know Zeus can do a perfect sit and high-five on command?",
          "Zeus once tried to catch a squirrel but ended up chasing his own tail instead.",
          "Zeus‚Äôs favorite game is fetch with his neon green ball.",
          "Remember to give Zeus plenty of fresh water on those hot rave nights.",
          "Zeus likes to nap in the weirdest places ‚Äî sometimes on the workbench!",
          "Zeus‚Äôs howl sounds like a mix between a wolf and a rapper‚Äôs beatbox.",
          "Zeus‚Äôs ears perk up instantly when he hears the car engine start.",
          "Zeus is the best co-pilot on car rides ‚Äî always ready for an adventure.",
          "Zeus once got rave lights stuck on his collar and looked like a disco dog!"
        ]
      };

      // Personal message for Dante
      const personalMessage = `Hey Dante! This hub is made just for you ‚Äî filled with all the things you love, from raves to lobsters, to your boy Zeus. Hope it brightens your day and keeps your ADHD brain entertained and energized. Love you tons! ‚ù§Ô∏è ‚Äî Larissa`;

      // State for current index per category
      const categoryIndices = {};

      // Elements
      const buttons = document.querySelectorAll('button[data-category]');
      const popupOverlay = document.getElementById('popup-overlay');
      const popupContent = document.getElementById('popup-content');
      const closePopupBtn = document.getElementById('close-popup');

      // Utility: clear popup and hide
      function closePopup() {
        popupOverlay.style.display = 'none';
        popupContent.innerHTML = '';
        popupOverlay.setAttribute('aria-hidden', 'true');
      }

      // Show content with Prev/Next navigation for text categories
      function showTextCategory(category) {
        const items = data[category];
        if (!items || items.length === 0) return;

        if (!(category in categoryIndices)) categoryIndices[category] = 0;

        function renderContent() {
          const idx = categoryIndices[category];
          popupContent.innerHTML = `
            <h3>${capitalizeWords(category.replace(/([A-Z])/g, ' $1'))}</h3>
            <p>${items[idx]}</p>
            <div class="popup-buttons" role="group" aria-label="Navigate content">
              <button id="prev-btn" ${idx === 0 ? 'disabled' : ''} aria-disabled="${idx === 0}">‚¨ÖÔ∏è Prev</button>
              <span aria-live="polite" aria-atomic="true" style="font-weight:bold; user-select:none;">${idx + 1} / ${items.length}</span>
              <button id="next-btn" ${idx === items.length - 1 ? 'disabled' : ''} aria-disabled="${idx === items.length - 1}">Next ‚û°Ô∏è</button>
            </div>
          `;
          popupOverlay.style.display = 'flex';
          popupOverlay.setAttribute('aria-hidden', 'false');
          popupContent.focus();

          // Attach handlers
          document.getElementById('prev-btn').onclick = () => {
            if (categoryIndices[category] > 0) {
              categoryIndices[category]--;
              renderContent();
            }
          };
          document.getElementById('next-btn').onclick = () => {
            if (categoryIndices[category] < items.length - 1) {
              categoryIndices[category]++;
              renderContent();
            }
          };
        }

        renderContent();
      }

      // Capitalize words utility
      function capitalizeWords(str) {
        return str.replace(/\b\w/g, c => c.toUpperCase());
      }

      // --- Mini Game: Lobster Catch ---
      function showMiniGame() {
        popupContent.innerHTML = `
          <h3>Lobster Rave Catch ü¶ûüéâ</h3>
          <div id="mini-game-container" aria-label="Lobster catching mini game" role="region">
            <canvas id="game-canvas" width="380" height="285" aria-describedby="game-instructions"></canvas>
            <p id="game-instructions" style="margin-top: 0.6rem; font-weight: 600; font-size: 0.95rem; color: #ffccffcc;">
              Use LEFT and RIGHT arrow keys to move Dante's net. Catch falling lobsters to score points!
            </p>
            <div id="game-controls">
              <button id="start-game-btn">Start Game</button>
              <button id="stop-game-btn" disabled>Stop Game</button>
              <span id="score-display" style="font-weight:bold; color:#ff7fff;">Score: 0</span>
            </div>
          </div>
        `;
        popupOverlay.style.display = 'flex';
        popupOverlay.setAttribute('aria-hidden', 'false');
        popupContent.focus();

        // Game variables
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const netWidth = 60;
        const netHeight = 20;
        const lobsterRadius = 15;

        let netX = canvas.width / 2 - netWidth / 2;
        let lobsters = [];
        let score = 0;
        let gameInterval;
        let lobsterInterval;
        let animationFrameId;
        let keysPressed = {};

        // Draw net function
        function drawNet() {
          ctx.fillStyle = '#bb33cc';
          ctx.shadowColor = '#ff56ffcc';
          ctx.shadowBlur = 10;
          ctx.fillRect(netX, canvas.height - netHeight - 10, netWidth, netHeight);
          ctx.shadowBlur = 0;
        }

        // Draw lobster function (circle)
        function drawLobster(lobster) {
          ctx.beginPath();
          ctx.fillStyle = '#ff33cc';
          ctx.shadowColor = '#ff77ffcc';
          ctx.shadowBlur = 8;
          ctx.arc(lobster.x, lobster.y, lobsterRadius, 0, Math.PI * 2);
          ctx.fill();
          ctx.shadowBlur = 0;
          // Claws
          ctx.beginPath();
          ctx.strokeStyle = '#ff99ff';
          ctx.lineWidth = 2;
          ctx.moveTo(lobster.x - 10, lobster.y);
          ctx.lineTo(lobster.x - 20, lobster.y - 10);
          ctx.moveTo(lobster.x + 10, lobster.y);
          ctx.lineTo(lobster.x + 20, lobster.y - 10);
          ctx.stroke();
        }

        // Update lobsters position
        function updateLobsters() {
          lobsters.forEach(lobster => {
            lobster.y += lobster.speed;
          });
          lobsters = lobsters.filter(lobster => lobster.y < canvas.height + lobsterRadius);
        }

        // Check collision between net and lobster
        function checkCollision() {
          lobsters.forEach((lobster, index) => {
            const netTop = canvas.height - netHeight - 10;
            const netBottom = canvas.height - 10;
            const netLeft = netX;
            const netRight = netX + netWidth;

            const lobX = lobster.x;
            const lobY = lobster.y;

            if (
              lobY + lobsterRadius >= netTop &&
              lobY - lobsterRadius <= netBottom &&
              lobX + lobsterRadius >= netLeft &&
              lobX - lobsterRadius <= netRight
            ) {
              // Caught!
              lobsters.splice(index, 1);
              score++;
              updateScore();
            }
          });
        }

        // Draw everything
        function draw() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          drawNet();
          lobsters.forEach(drawLobster);
        }

        // Update game state
        function gameLoop() {
          if (keysPressed['ArrowLeft']) {
            netX -= 7;
            if (netX < 0) netX = 0;
          }
          if (keysPressed['ArrowRight']) {
            netX += 7;
            if (netX + netWidth > canvas.width) netX = canvas.width - netWidth;
          }
          updateLobsters();
          checkCollision();
          draw();
          animationFrameId = requestAnimationFrame(gameLoop);
        }

        // Create a new lobster at random x with random speed
        function spawnLobster() {
          const x = Math.random() * (canvas.width - lobsterRadius * 2) + lobsterRadius;
          const speed = 2 + Math.random() * 2;
          lobsters.push({ x, y: -lobsterRadius, speed });
        }

        // Update score display
        function updateScore() {
          const scoreSpan = document.getElementById('score-display');
          if (scoreSpan) scoreSpan.textContent = `Score: ${score}`;
        }

        // Start game function
        function startGame() {
          score = 0;
          lobsters = [];
          netX = canvas.width / 2 - netWidth / 2;
          updateScore();
          document.getElementById('start-game-btn').disabled = true;
          document.getElementById('stop-game-btn').disabled = false;
          window.addEventListener('keydown', keyDownHandler);
          window.addEventListener('keyup', keyUpHandler);
          gameLoop();
          lobsterInterval = setInterval(spawnLobster, 1200);
        }

        // Stop game function
        function stopGame() {
          document.getElementById('start-game-btn').disabled = false;
          document.getElementById('stop-game-btn').disabled = true;
          window.removeEventListener('keydown', keyDownHandler);
          window.removeEventListener('keyup', keyUpHandler);
          lobsters = [];
          keysPressed = {};
          cancelAnimationFrame(animationFrameId);
          clearInterval(lobsterInterval);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          popupContent.querySelector('#score-display').textContent = `Final Score: ${score}`;
        }

        // Keyboard handlers
        function keyDownHandler(e) {
          if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
            keysPressed[e.key] = true;
            e.preventDefault();
          }
        }
        function keyUpHandler(e) {
          if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
            keysPressed[e.key] = false;
            e.preventDefault();
          }
        }

        // Attach buttons handlers
        document.getElementById('start-game-btn').onclick = startGame;
        document.getElementById('stop-game-btn').onclick = stopGame;
      }

      // --- DanteBot: simple AI chat ---
      function showDanteBot() {
        popupContent.innerHTML = `
          <h3>Chat with DanteBot ü§ñ</h3>
          <div id="dantebot-container" role="region" aria-live="polite" aria-label="Chat conversation">
            <div id="dantebot-log" tabindex="0" aria-live="polite" aria-atomic="true"></div>
            <div id="dantebot-input-container">
              <input type="text" id="dantebot-input" aria-label="Type your message here" placeholder="Say hi to DanteBot..." autocomplete="off" />
              <button id="dantebot-send" aria-label="Send message">Send</button>
            </div>
          </div>
        `;
        popupOverlay.style.display = 'flex';
        popupOverlay.setAttribute('aria-hidden', 'false');
        popupContent.focus();

        const log = document.getElementById('dantebot-log');
        const input = document.getElementById('dantebot-input');
        const sendBtn = document.getElementById('dantebot-send');

        // Simple responses database
        const responses = [
          "Yo Dante! What‚Äôs on your mind today?",
          "That‚Äôs lit! Tell me more.",
          "Sounds like a plan!",
          "Haha, that‚Äôs a good one!",
          "I hear you, dude.",
          "Keep grinding, you're doing awesome.",
          "Need a snack idea? I gotchu.",
          "Zeus says woof! üê∂",
          "Rave on! üíú",
          "Got any dark jokes to share?",
          "Engineering is magic, right?",
          "I‚Äôm here to hype you up!",
          "Lobsters and raves make life better.",
          "Want a daily challenge to level up?",
          "I'm always down for a good laugh."
        ];

        // Append message to log
        function appendMessage(sender, message) {
          const msgDiv = document.createElement('div');
          msgDiv.textContent = (sender === 'bot' ? 'ü§ñ DanteBot: ' : 'You: ') + message;
          msgDiv.style.marginBottom = '6px';
          msgDiv.style.whiteSpace = 'pre-wrap';
          msgDiv.style.fontWeight = sender === 'bot' ? '700' : '600';
          msgDiv.style.color = sender === 'bot' ? '#dd99ff' : '#ffd9ff';
          log.appendChild(msgDiv);
          log.scrollTop = log.scrollHeight;
        }

        // Respond with random message after a short delay
        function respond() {
          const randomIndex = Math.floor(Math.random() * responses.length);
          setTimeout(() => {
            appendMessage('bot', responses[randomIndex]);
          }, 800);
        }

        // Initial greeting
        appendMessage('bot', personalMessage);

        // Handle send
        function sendMessage() {
          const msg = input.value.trim();
          if (!msg) return;
          appendMessage('user', msg);
          input.value = '';
          respond();
        }

        sendBtn.onclick = sendMessage;
        input.onkeydown = (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            sendMessage();
          }
        };

        // Focus input on popup open
        input.focus();
      }

      // Main event listeners
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          const category = btn.getAttribute('data-category');
          if (category === 'miniGames') {
            showMiniGame();
          } else if (category === 'danteBot') {
            showDanteBot();
          } else {
            showTextCategory(category);
          }
        });
      });

      closePopupBtn.addEventListener('click', () => {
        closePopup();
      });

      // Close popup on overlay click outside content
      popupOverlay.addEventListener('click', (e) => {
        if (e.target === popupOverlay) closePopup();
      });

      // Close popup with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && popupOverlay.style.display === 'flex') {
          closePopup();
        }
      });
    })();
  </script>
</body>
</html>