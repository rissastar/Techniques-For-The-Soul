<!DOCTYPE html>
<html lang="en" data-theme="neon">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Dante‚Äôs Dopamine Dive 3.2</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Roboto+Mono&display=swap');
    :root {
      --neon-pink: #ff2d95;
      --neon-blue: #2df4ff;
      --neon-green: #2dff95;
      --neon-yellow: #fff42d;
      --bg-dark: #0a0a1a;
      --text-light: #f0f0f0;
      --button-bg: #1a1a3a;
      --button-hover: #ff2d95;
      --confetti-colors: var(--neon-pink), var(--neon-blue), var(--neon-green), var(--neon-yellow);
    }

    * {
      box-sizing: border-box;
    }
    body {
      margin: 0; padding: 0;
      background: var(--bg-dark);
      color: var(--text-light);
      font-family: 'Roboto Mono', monospace;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      user-select: none;
    }
    h1 {
      font-family: 'Fredoka One', cursive;
      font-size: 2.8rem;
      text-align: center;
      margin: 1rem 0 0.5rem;
      color: var(--neon-pink);
      text-shadow:
        0 0 8px var(--neon-pink),
        0 0 15px var(--neon-pink),
        0 0 20px var(--neon-pink);
    }
    h2 {
      font-family: 'Fredoka One', cursive;
      color: var(--neon-blue);
      text-align: center;
      margin-top: 1rem;
      text-shadow:
        0 0 6px var(--neon-blue),
        0 0 12px var(--neon-blue);
    }

    main {
      flex: 1;
      max-width: 480px;
      margin: 0 auto;
      padding: 0 1rem 3rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      user-select: none;
    }

    /* Game container */
    #gameContainer {
      background: #111126;
      border: 3px solid var(--neon-pink);
      border-radius: 15px;
      padding: 1rem;
      position: relative;
      box-shadow:
        0 0 12px var(--neon-pink),
        inset 0 0 8px var(--neon-pink);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    canvas {
      background: #0a0a1a;
      border-radius: 12px;
      width: 100%;
      height: 320px;
      max-height: 320px;
      image-rendering: pixelated;
      user-select: none;
      touch-action: none;
      outline: none;
    }

    #scoreDisplay {
      color: var(--neon-yellow);
      font-size: 1.5rem;
      margin-top: 0.8rem;
      font-weight: bold;
      text-shadow:
        0 0 8px var(--neon-yellow);
    }

    #touchControls {
      margin-top: 1rem;
      width: 100%;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
    }
    .controlBtn {
      flex: 1;
      background: var(--button-bg);
      border: 2px solid var(--neon-blue);
      color: var(--neon-blue);
      font-family: 'Fredoka One', cursive;
      font-size: 1.6rem;
      padding: 0.75rem 0;
      border-radius: 12px;
      box-shadow:
        0 0 8px var(--neon-blue);
      user-select: none;
      cursor: pointer;
      transition: background-color 0.25s ease, color 0.25s ease;
      text-align: center;
      user-select: none;
    }
    .controlBtn:active,
    .controlBtn:hover {
      background: var(--neon-blue);
      color: var(--bg-dark);
      box-shadow:
        0 0 16px var(--neon-blue),
        0 0 28px var(--neon-blue);
    }
    .controlBtn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      box-shadow: none;
    }

    #startGameBtn, #stopGameBtn {
      margin: 0.75rem 0 0.25rem;
      width: 100%;
      font-family: 'Fredoka One', cursive;
      font-size: 1.6rem;
      padding: 0.8rem 0;
      border-radius: 14px;
      border: 3px solid var(--neon-pink);
      background: var(--button-bg);
      color: var(--neon-pink);
      cursor: pointer;
      box-shadow:
        0 0 10px var(--neon-pink);
      transition: background-color 0.3s ease, color 0.3s ease;
      user-select: none;
    }
    #startGameBtn:hover:not(:disabled),
    #stopGameBtn:hover:not(:disabled) {
      background: var(--neon-pink);
      color: var(--bg-dark);
      box-shadow:
        0 0 24px var(--neon-pink),
        0 0 40px var(--neon-pink);
    }
    #stopGameBtn {
      display: none;
    }

    /* DanteBot Chat Section */
    #chatContainer {
      background: #111126;
      border: 3px solid var(--neon-green);
      border-radius: 15px;
      padding: 1rem;
      box-shadow:
        0 0 12px var(--neon-green),
        inset 0 0 8px var(--neon-green);
      display: flex;
      flex-direction: column;
      max-height: 350px;
    }
    #response {
      background: #0a0a1a;
      border-radius: 12px;
      color: var(--neon-green);
      font-family: 'Roboto Mono', monospace;
      font-size: 1rem;
      padding: 1rem;
      overflow-y: auto;
      white-space: pre-wrap;
      flex-grow: 1;
      user-select: text;
      box-shadow: inset 0 0 10px var(--neon-green);
    }
    #chatInputArea {
      margin-top: 1rem;
      display: flex;
      gap: 0.75rem;
    }
    #userInput {
      flex-grow: 1;
      padding: 0.6rem 0.75rem;
      font-size: 1.2rem;
      border-radius: 12px;
      border: 2px solid var(--neon-green);
      background: #0a0a1a;
      color: var(--neon-green);
      font-family: 'Roboto Mono', monospace;
      box-shadow: inset 0 0 10px var(--neon-green);
      outline: none;
      user-select: text;
    }
    #userInput::placeholder {
      color: #446644aa;
    }
    #sendBtn {
      background: var(--button-bg);
      border: 3px solid var(--neon-green);
      color: var(--neon-green);
      font-family: 'Fredoka One', cursive;
      font-size: 1.3rem;
      padding: 0.55rem 1.2rem;
      border-radius: 14px;
      cursor: pointer;
      box-shadow:
        0 0 10px var(--neon-green);
      user-select: none;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    #sendBtn:hover {
      background: var(--neon-green);
      color: var(--bg-dark);
      box-shadow:
        0 0 20px var(--neon-green),
        0 0 30px var(--neon-green);
    }

    /* Confetti styles */
    canvas.confetti {
      position: fixed !important;
      pointer-events: none !important;
      top: 0; left: 0;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 9999 !important;
    }

    /* Responsive tweaks */
    @media (max-width: 400px) {
      h1 {
        font-size: 2rem;
      }
      canvas {
        height: 240px;
      }
    }

  </style>
</head>
<body>
  <h1>Dante‚Äôs Dopamine Dive</h1>

  <main>

    <!-- Game Section -->
    <section id="gameContainer" aria-label="Lobster Catch Mini-Game">
      <canvas id="gameCanvas" tabindex="0" aria-label="Lobster Catch Game Canvas"></canvas>
      <div id="scoreDisplay" aria-live="polite" aria-atomic="true">Score: 0</div>

      <div id="touchControls" role="group" aria-label="Game Movement Controls">
        <button class="controlBtn" id="leftBtn" aria-label="Move Left" type="button">‚¨ÖÔ∏è Left</button>
        <button class="controlBtn" id="rightBtn" aria-label="Move Right" type="button">Right ‚û°Ô∏è</button>
      </div>

      <button id="startGameBtn" type="button" aria-pressed="false">Start Game</button>
      <button id="stopGameBtn" type="button" aria-pressed="false">Stop Game</button>
    </section>

    <!-- Chat Section -->
    <section id="chatContainer" aria-label="DanteBot Chat">
      <h2>DanteBot Chat ü§ñ</h2>
      <pre id="response" role="log" aria-live="polite" aria-atomic="false"></pre>
      <div id="chatInputArea">
        <textarea id="userInput" rows="2" placeholder="Type a message for DanteBot..." aria-label="Message input"></textarea>
        <button id="sendBtn" type="button" aria-label="Send message">Send</button>
      </div>
    </section>

  </main>

  <script>
    // ========== Lobster Catch Game ==========

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const startGameBtn = document.getElementById('startGameBtn');
    const stopGameBtn = document.getElementById('stopGameBtn');
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');

    // Set canvas size considering devicePixelRatio for sharpness
    function resizeCanvas() {
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.scale(dpr, dpr);
    }
    resizeCanvas();
    window.addEventListener('resize', () => {
      resizeCanvas();
    });

    // Game variables
    const canvasWidth = canvas.clientWidth;
    const canvasHeight = canvas.clientHeight;
    const playerWidth = 60;
    const playerHeight = 40;
    const lobsterSize = 40;
    let playerX = canvasWidth / 2 - playerWidth / 2;
    const playerY = canvasHeight - playerHeight - 10;
    let lobsters = [];
    let score = 0;
    let gameRunning = false;
    let moveLeft = false;
    let moveRight = false;

    // Draw player (lobster catcher)
    function drawPlayer() {
      ctx.fillStyle = 'cyan';
      ctx.strokeStyle = '#00ffffcc';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(playerX, playerY + playerHeight);
      ctx.lineTo(playerX + playerWidth * 0.5, playerY);
      ctx.lineTo(playerX + playerWidth, playerY + playerHeight);
      ctx.closePath();
      ctx.fill();
      ctx.stroke();
      // Add detail - "catcher net" handle
      ctx.strokeStyle = 'white';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(playerX + playerWidth * 0.5, playerY);
      ctx.lineTo(playerX + playerWidth * 0.5, playerY + playerHeight + 20);
      ctx.stroke();
    }

    // Draw a lobster
    function drawLobster(x, y) {
      // Lobster body - red oval
      ctx.fillStyle = '#ff2222';
      ctx.strokeStyle = '#aa0000';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.ellipse(x, y, lobsterSize / 2, lobsterSize / 3, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.stroke();
      // Lobster claws
      ctx.strokeStyle = '#cc0000';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(x - lobsterSize / 3, y);
      ctx.lineTo(x - lobsterSize / 2, y - lobsterSize / 2);
      ctx.moveTo(x + lobsterSize / 3, y);
      ctx.lineTo(x + lobsterSize / 2, y - lobsterSize / 2);
      ctx.stroke();
      // Lobster eyes
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.arc(x - 7, y - 5, 4, 0, Math.PI * 2);
      ctx.arc(x + 7, y - 5, 4, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = 'black';
      ctx.beginPath();
      ctx.arc(x - 7, y - 5, 2, 0, Math.PI * 2);
      ctx.arc(x + 7, y - 5, 2, 0, Math.PI * 2);
      ctx.fill();
    }

    // Check collision between lobster and player (simple box overlap)
    function checkCollision(lobster) {
      const lobX = lobster.x;
      const lobY = lobster.y;
      const playerLeft = playerX;
      const playerRight = playerX + playerWidth;
      const playerTop = playerY;
      const playerBottom = playerY + playerHeight + 20; // include handle

      // Simple collision: lobster within horizontal range and close vertically
      return (
        lobX > playerLeft &&
        lobX < playerRight &&
        lobY + lobsterSize / 2 > playerTop &&
        lobY - lobsterSize / 2 < playerBottom
      );
    }

    // Confetti particles for celebration
    const confettiParticles = [];
    const confettiColors = ['#ff2d95', '#2df4ff', '#2dff95', '#fff42d'];
    function createConfetti() {
      for (let i = 0; i < 100; i++) {
        confettiParticles.push({
          x: Math.random() * window.innerWidth,
          y: Math.random() * -window.innerHeight,
          size: (Math.random() * 6) + 4,
          speed: Math.random() * 5 + 2,
          color: confettiColors[Math.floor(Math.random() * confettiColors.length)],
          tilt: Math.random() * 10,
          tiltSpeed: Math.random() * 0.1 + 0.05,
        });
      }
    }
    let confettiCanvas, confettiCtx;

    function setupConfetti() {
      confettiCanvas = document.createElement('canvas');
      confettiCanvas.classList.add('confetti');
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
      confettiCtx = confettiCanvas.getContext('2d');
      document.body.appendChild(confettiCanvas);
      createConfetti();
      requestAnimationFrame(updateConfetti);
    }
    function updateConfetti() {
      if (!confettiCanvas) return;
      confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      for (let i = 0; i < confettiParticles.length; i++) {
        const p = confettiParticles[i];
        p.y += p.speed;
        p.x += Math.sin(p.tilt) * 0.5;
        p.tilt += p.tiltSpeed;
        confettiCtx.fillStyle = p.color;
        confettiCtx.beginPath();
        confettiCtx.ellipse(p.x, p.y, p.size, p.size / 2, p.tilt, 0, Math.PI * 2);
        confettiCtx.fill();

        if (p.y > confettiCanvas.height) {
          p.y = -10;
          p.x = Math.random() * confettiCanvas.width;
        }
      }
      if (gameRunning) {
        requestAnimationFrame(updateConfetti);
      } else {
        document.body.removeChild(confettiCanvas);
        confettiCanvas = null;
        confettiParticles.length = 0;
      }
    }
    function launchConfetti() {
      if (!confettiCanvas) {
        setupConfetti();
      }
      setTimeout(() => {
        // Stop confetti after 2.5s
        gameRunning = false;
      }, 2500);
    }

    // Update and draw game
    function updateGame() {
      if (!gameRunning) return;

      // Clear canvas
      ctx.clearRect(0, 0, canvasWidth, canvasHeight);

      // Move player based on keys or buttons pressed
      if (moveLeft) {
        playerX -= 7;
        if (playerX < 0) playerX = 0;
      }
      if (moveRight) {
        playerX += 7;
        if (playerX > canvasWidth - playerWidth) playerX = canvasWidth - playerWidth;
      }

      // Draw player
      drawPlayer();

      // Move lobsters down
      for (let i = lobsters.length - 1; i >= 0; i--) {
        lobsters[i].y += lobsters[i].speed;

        // Check if caught
        if (checkCollision(lobsters[i])) {
          lobsters.splice(i, 1);
          score++;
          scoreDisplay.textContent = `Score: ${score}`;
          launchConfetti();
          continue;
        }

        // Remove if out of bottom
        if (lobsters[i].y > canvasHeight + lobsterSize) {
          lobsters.splice(i, 1);
          continue;
        }
      }

      // Occasionally spawn new lobster
      if (Math.random() < 0.03) {
        lobsters.push({
          x: Math.random() * (canvasWidth - lobsterSize) + lobsterSize / 2,
          y: -lobsterSize,
          speed: 2 + Math.random() * 2,
        });
      }

      // Draw lobsters
      lobsters.forEach(l => drawLobster(l.x, l.y));

      requestAnimationFrame(updateGame);
    }

    // Control handlers
    function onLeftDown() {
      moveLeft = true;
    }
    function onLeftUp() {
      moveLeft = false;
    }
    function onRightDown() {
      moveRight = true;
    }
    function onRightUp() {
      moveRight = false;
    }

    leftBtn.addEventListener('touchstart', e => { e.preventDefault(); onLeftDown(); });
    leftBtn.addEventListener('touchend', e => { e.preventDefault(); onLeftUp(); });
    leftBtn.addEventListener('mousedown', e => { e.preventDefault(); onLeftDown(); });
    leftBtn.addEventListener('mouseup', e => { e.preventDefault(); onLeftUp(); });
    leftBtn.addEventListener('mouseleave', e => { e.preventDefault(); onLeftUp(); });

    rightBtn.addEventListener('touchstart', e => { e.preventDefault(); onRightDown(); });
    rightBtn.addEventListener('touchend', e => { e.preventDefault(); onRightUp(); });
    rightBtn.addEventListener('mousedown', e => { e.preventDefault(); onRightDown(); });
    rightBtn.addEventListener('mouseup', e => { e.preventDefault(); onRightUp(); });
    rightBtn.addEventListener('mouseleave', e => { e.preventDefault(); onRightUp(); });

    // Keyboard control support
    window.addEventListener('keydown', (e) => {
      if (!gameRunning) return;
      if (e.code === 'ArrowLeft') moveLeft = true;
      if (e.code === 'ArrowRight') moveRight = true;
    });
    window.addEventListener('keyup', (e) => {
      if (e.code === 'ArrowLeft') moveLeft = false;
      if (e.code === 'ArrowRight') moveRight = false;
    });

    // Start and stop game functions
    startGameBtn.addEventListener('click', () => {
      if (gameRunning) return;
      gameRunning = true;
      score = 0;
      scoreDisplay.textContent = 'Score: 0';
      lobsters = [];
      playerX = canvasWidth / 2 - playerWidth / 2;
      startGameBtn.style.display = 'none';
      stopGameBtn.style.display = 'block';
      updateGame();
      canvas.focus();
    });

    stopGameBtn.addEventListener('click', () => {
      gameRunning = false;
      startGameBtn.style.display = 'block';
      stopGameBtn.style.display = 'none';
    });

    // ========== DanteBot Chat ==========

    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const response = document.getElementById('response');

    // Simple AI replies based on keywords
    function generateDanteBotReply(input) {
      const lower = input.toLowerCase();

      if (!input.trim()) return "Hey, you didn't say anything! Try typing something fun or ask me about lobsters! ü¶û";

      if (lower.includes('lobster')) {
        return "Lobsters are awesome! Did you know they taste with their legs? Pretty wild, huh?";
      }
      if (lower.includes('dante')) {
        return "Dante is the coolest dude around! Big shoutout to him! üéâ";
      }
      if (lower.includes('rave') || lower.includes('party')) {
        return "Ready to rave all night? Let‚Äôs keep those dopamine levels high! üíÉüï∫";
      }
      if (lower.includes('joke') || lower.includes('funny')) {
        return "Why don‚Äôt lobsters share their food? Because they‚Äôre a little shellfish! üòÑ";
      }
      if (lower.includes('help')) {
        return "Need a hand? Just keep playing the lobster catch or chat with me ‚Äî I‚Äôm here for you!";
      }
      if (lower.includes('hello') || lower.includes('hi') || lower.includes('hey')) {
        return "Hey there! What‚Äôs on your mind today?";
      }
      // Fallback: encourage creativity
      return "That sounds interesting! Tell me more or try asking about lobsters, raves, or Dante!";
    }

    function appendChatMessage(message, isUser = false) {
      const prefix = isUser ? "You: " : "DanteBot: ";
      response.textContent += prefix + message + "\n\n";
      response.scrollTop = response.scrollHeight;
    }

    sendBtn.addEventListener('click', () => {
      const message = userInput.value.trim();
      if (!message) return;
      appendChatMessage(message, true);
      userInput.value = '';
      setTimeout(() => {
        const reply = generateDanteBotReply(message);
        appendChatMessage(reply);
      }, 400);
    });

    // Also send message on Enter (shift+enter for newline)
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendBtn.click();
      }
    });

    // Focus game canvas on load for keyboard support
    window.addEventListener('load', () => {
      canvas.setAttribute('tabindex', '0');
    });

  </script>
</body>
</html>