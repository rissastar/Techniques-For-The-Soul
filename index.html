<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sleep Spinner</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom, #dce9f9, #e6d8f7);
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    h1 {
      color: #6b4fa0;
      margin-bottom: 20px;
      user-select: none;
    }

    .spinner-container {
      position: relative;
      width: 320px;
      height: 320px;
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 10px solid #c8b6e2;
      position: relative;
      overflow: hidden;
      transform: rotate(0deg);
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
      user-select: none;
    }

    .wheel div {
      position: absolute;
      width: 50%;
      height: 50%;
      background: #fff;
      transform-origin: 100% 100%;
      clip-path: polygon(0 0, 100% 0, 100% 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      font-weight: bold;
      padding: 8px;
      text-align: center;
      color: #5e4b8b;
      user-select: none;
    }

    .arrow {
      width: 0; 
      height: 0; 
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid #f7c948;
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      user-select: none;
    }

    button {
      margin-top: 20px;
      padding: 12px 24px;
      background-color: #a88ce1;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    button:hover {
      background-color: #8c6ad8;
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: #333;
      padding: 30px 30px 40px 30px;
      border-radius: 12px;
      box-shadow: 0px 5px 25px rgba(0,0,0,0.3);
      display: none;
      z-index: 10;
      max-width: 90%;
      width: 420px;
      font-size: 15px;
      line-height: 1.5;
      user-select: text;
    }

    .popup h2 {
      margin-top: 0;
      margin-bottom: 12px;
      color: #6b4fa0;
      font-weight: 700;
      user-select: text;
    }

    .overlay {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0; left: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 9;
      user-select: none;
    }

    .close {
      background: #f7c948;
      border: none;
      padding: 10px 16px;
      margin-top: 20px;
      cursor: pointer;
      border-radius: 6px;
      font-weight: 600;
      user-select: none;
      transition: background-color 0.3s ease;
    }

    .close:hover {
      background: #e2b733;
    }
  </style>
</head>
<body>
  <h1>üé° Sleepy Spinner</h1>
  <div class="spinner-container">
    <div class="arrow" aria-hidden="true"></div>
    <div class="wheel" id="wheel" aria-live="polite" aria-atomic="true"></div>
  </div>
  <button onclick="spin()" aria-label="Spin the sleep game spinner">Spin</button>

  <div class="overlay" id="overlay" tabindex="-1" aria-hidden="true"></div>
  <div class="popup" id="popup" role="dialog" aria-modal="true" aria-labelledby="gameTitle" aria-describedby="gameDesc">
    <h2 id="gameTitle"></h2>
    <p id="gameDesc"></p>
    <button class="close" onclick="closePopup()" aria-label="Close instructions">Close</button>
  </div>

  <script>
    const games = [
      { 
        title: "üåô 4-7-8 Breathing", 
        desc: "Calm your mind with this relaxing breath pattern:\n\n‚Ä¢ Inhale quietly through your nose for 4 seconds.\n‚Ä¢ Hold your breath gently for 7 seconds.\n‚Ä¢ Exhale slowly and fully through your mouth for 8 seconds.\n\nRepeat this cycle 4 times. Feel your body getting lighter and more relaxed with each breath." 
      },
      { 
        title: "üß∏ Imaginary Room", 
        desc: "Create a peaceful room in your mind:\n\n‚Ä¢ Imagine a cozy room filled with your favorite things.\n‚Ä¢ Picture soft pillows, warm lighting, and calming colors.\n‚Ä¢ Explore the room slowly, noticing small details.\n\nStay in this safe space and let your body relax." 
      },
      { 
        title: "üé® Air Drawing", 
        desc: "Draw shapes in the air with your finger:\n\n‚Ä¢ Slowly trace circles, stars, or waves with your finger.\n‚Ä¢ Focus on the smooth, gentle movement.\n‚Ä¢ Imagine the shapes glowing softly as you draw.\n\nThis helps calm your thoughts and ease tension." 
      },
      { 
        title: "üõÅ Cocoa Body Scan", 
        desc: "Imagine warm, flowing cocoa relaxing you:\n\n‚Ä¢ Picture warm, melted cocoa pouring over your head.\n‚Ä¢ Feel it slowly moving down your neck, arms, torso, legs, and feet.\n‚Ä¢ As the cocoa flows, your muscles relax deeply.\n\nVisualize this soothing warmth washing away stress." 
      },
      { 
        title: "üí≠ 5-4-3-2-1 Grounding", 
        desc: "Use your senses to ground yourself:\n\n‚Ä¢ Name 5 things you can see around you.\n‚Ä¢ Name 4 things you can touch.\n‚Ä¢ Name 3 things you can hear.\n‚Ä¢ Name 2 things you can smell.\n‚Ä¢ Name 1 thing you can taste.\n\nFocus on the present moment and feel calm." 
      },
      { 
        title: "ü™ê Dream Elevator", 
        desc: "Imagine an elevator to magical places:\n\n‚Ä¢ Step into a quiet elevator.\n‚Ä¢ Press a button for a dreamy, peaceful floor.\n‚Ä¢ With each floor, see beautiful, calming worlds unfold.\n\nLet your mind wander softly to these places." 
      },
      { 
        title: "üéß Sound Tracker", 
        desc: "Notice sounds without reacting:\n\n‚Ä¢ Listen carefully to soft sounds nearby.\n‚Ä¢ Count each sound quietly in your mind.\n‚Ä¢ Don‚Äôt judge or respond‚Äîjust notice.\n\nThis gentle awareness helps slow your mind." 
      },
      { 
        title: "üåå Star Collector", 
        desc: "Catch calm stars floating in your mind:\n\n‚Ä¢ Imagine tiny stars drifting slowly around you.\n‚Ä¢ Reach out and catch each one gently.\n‚Ä¢ Feel calmness fill you with each star caught.\n\nKeep collecting stars until you feel sleepy." 
      },
      { 
        title: "üêö Ocean Breath", 
        desc: "Breathe like gentle ocean waves:\n\n‚Ä¢ Inhale slowly as the wave comes in.\n‚Ä¢ Exhale gently as the wave goes out.\n‚Ä¢ Feel the rhythm soothe your whole body.\n\nRepeat until your breathing feels smooth and calm." 
      },
      { 
        title: "üéÅ Gratitude Glow", 
        desc: "Think of three things you‚Äôre thankful for:\n\n‚Ä¢ They can be big or small.\n‚Ä¢ Feel a warm glow spreading in your chest.\n‚Ä¢ Let this glow relax and comfort you.\n\nThis warms your heart and quiets your mind." 
      },
      { 
        title: "üåà Rainbow Path", 
        desc: "Walk a colorful rainbow trail in your mind:\n\n‚Ä¢ Imagine stepping onto a soft, glowing rainbow.\n‚Ä¢ Feel the colors under your feet, bright and gentle.\n‚Ä¢ Walk slowly, noticing each color‚Äôs warmth.\n\nThis peaceful walk helps your mind rest." 
      },
      { 
        title: "üõå Cloud Bed", 
        desc: "Lie down on a soft, fluffy cloud:\n\n‚Ä¢ Imagine a big cloud gently cradling your body.\n‚Ä¢ Feel it molding softly to you.\n‚Ä¢ Let your body sink deeper with every breath.\n\nFeel safe and comfortable as you relax." 
      },
      { 
        title: "ü¶Ñ Magical Creature", 
        desc: "Cuddle a soft imaginary friend:\n\n‚Ä¢ Picture a gentle creature with soft fur.\n‚Ä¢ Feel its warmth and calm as you hug it.\n‚Ä¢ Let its peaceful energy soothe you.\n\nThis loving connection helps you relax." 
      },
      { 
        title: "ü™û Calm Mirror", 
        desc: "See your calm self in a mirror:\n\n‚Ä¢ Imagine a mirror reflecting your peaceful face.\n‚Ä¢ Watch calmness grow in your eyes and smile.\n‚Ä¢ Step into the reflection, becoming that calm self.\n\nFeel your body and mind soften." 
      },
      { 
        title: "üïäÔ∏è Falling Feathers", 
        desc: "Count feathers drifting down slowly:\n\n‚Ä¢ Picture light feathers floating gently in the air.\n‚Ä¢ Watch them fall one by one.\n‚Ä¢ Count quietly, feeling relaxed with each feather.\n\nLet this peaceful rhythm slow your mind." 
      },
      { 
        title: "üå∫ Flower Breath", 
        desc: "Smell a blooming flower and blow petals:\n\n‚Ä¢ Imagine holding a beautiful flower.\n‚Ä¢ Take a deep breath in, smelling its scent.\n‚Ä¢ Blow softly to scatter its petals.\n\nRepeat this slow, gentle breath to relax." 
      },
      { 
        title: "üìö Storytime", 
        desc: "Create a cozy bedtime story:\n\n‚Ä¢ Think of a calm setting, like a forest or beach.\n‚Ä¢ Imagine gentle characters and peaceful events.\n‚Ä¢ Tell the story softly in your mind.\n\nLet the story carry you toward sleep." 
      },
      { 
        title: "üéà Balloon Breaths", 
        desc: "Breathe like inflating and deflating a balloon:\n\n‚Ä¢ Inhale slowly, filling your belly like a balloon.\n‚Ä¢ Exhale gently, letting the balloon deflate.\n‚Ä¢ Repeat this smooth breath rhythm.\n\nFeel tension float away with each breath." 
      },
      { 
        title: "üé† Carousel Dreams", 
        desc: "Ride a gentle carousel in a dream:\n\n‚Ä¢ Imagine sitting on a soft, glowing carousel horse.\n‚Ä¢ Feel it move slowly and smoothly.\n‚Ä¢ Watch calming lights and colors spin around.\n\nLet the rhythm lull you closer to sleep." 
      },
      { 
        title: "üé∂ Lullaby Loop", 
        desc: "Hum a soft tune in your head:\n\n‚Ä¢ Choose a simple, calming melody.\n‚Ä¢ Hum slowly and gently.\n‚Ä¢ Let the music soothe your thoughts.\n\nThis quiet song helps your mind relax." 
      },
      { 
        title: "üêæ Footsteps", 
        desc: "Imagine soft footsteps in warm sand:\n\n‚Ä¢ Picture walking slowly along a beach.\n‚Ä¢ Feel the soft sand under your feet.\n‚Ä¢ Hear your footsteps quiet and steady.\n\nThis peaceful walk helps you unwind." 
      },
      { 
        title: "ü´ß Bubble Float", 
        desc: "Float inside a big, gentle bubble:\n\n‚Ä¢ Imagine yourself in a clear, shiny bubble.\n‚Ä¢ Feel it drifting slowly through the air.\n‚Ä¢ Notice the calm and quiet inside.\n\nRelax deeply as you float peacefully." 
      },
      { 
        title: "üèïÔ∏è Campfire Crackle", 
        desc: "Picture a warm campfire crackling softly:\n\n‚Ä¢ See glowing embers flicker gently.\n‚Ä¢ Hear soft pops and crackles.\n‚Ä¢ Feel cozy warmth spreading inside.\n\nLet this peaceful fire calm you." 
      },
      { 
        title: "üêõ Cocoon Wrap", 
        desc: "Wrap yourself in a soft cocoon of light:\n\n‚Ä¢ Imagine a warm, glowing light cocoon.\n‚Ä¢ Feel it wrapping you snug and safe.\n‚Ä¢ Let the light soothe and relax your whole body.\n\nRest deeply wrapped in calmness." 
      },
      { 
        title: "üí° Dream Light", 
        desc: "Dim an imaginary light with your breath:\n\n‚Ä¢ Picture a gentle light shining softly.\n‚Ä¢ Inhale slowly and imagine dimming the light.\n‚Ä¢ Exhale fully and see it glow even softer.\n\nRepeat until the light fades peacefully." 
      },
      { 
        title: "üéÇ Candle Game", 
        desc: "Blow out candles one by one with breath:\n\n‚Ä¢ Imagine a row of glowing candles.\n‚Ä¢ Take a deep breath and blow out the first candle.\n‚Ä¢ Repeat until all candles gently fade.\n\nFeel relaxed as darkness grows softly." 
      },
      { 
        title: "üö™ Door to Dreams", 
        desc: "Open a glowing door to your dream world:\n\n‚Ä¢ Imagine a shining door in front of you.\n‚Ä¢ Reach out and open it slowly.\n‚Ä¢ Step through into a calm, magical place.\n\nExplore gently and feel safe and relaxed." 
      },
      { 
        title: "üß¶ Warm Socks", 
        desc: "Feel cozy socks warming your feet:\n\n‚Ä¢ Imagine sliding on soft, warm socks.\n‚Ä¢ Feel the comforting warmth spreading up your legs.\n‚Ä¢ Let this cozy feeling calm your body.\n\nStay warm and peaceful as you relax." 
      },
      { 
        title: "üß≠ Star Compass", 
        desc: "Follow your dream compass in the sky:\n\n‚Ä¢ Picture a glowing compass pointing to calm places.\n‚Ä¢ Follow its gentle pull through starry skies.\n‚Ä¢ Let the journey bring peace and quiet.\n\nFeel guided and soothed by this calm path." 
      },
      { 
        title: "üå† Wish Whispers", 
        desc: "Send quiet wishes to the stars above:\n\n‚Ä¢ Think of a kind wish or hope.\n‚Ä¢ Whisper it softly to the night sky.\n‚Ä¢ Watch stars twinkle as they carry your wish.\n\nLet hope and calmness fill your heart." 
      }
    ];

    const wheel = document.getElementById("wheel");
    const segments = games.length;
    const angle = 360 / segments;

    // Build spinner segments
    games.forEach((game, i) => {
      const segment = document.createElement("div");
      segment.style.transform = `rotate(${i * angle}deg) skewY(-${90 - angle}deg)`;
      segment.style.backgroundColor = i % 2 === 0 ? "#d5c6f0" : "#f3f1f8";
      segment.innerText = game.title;
      segment.setAttribute("aria-label", `Sleep game: ${game.title}`);
      wheel.appendChild(segment);
    });

    let currentRotation = 0;

    function spin() {
      const randomIndex = Math.floor(Math.random() * segments);
      const spinAmount = 360 * 6 + (360 - randomIndex * angle - angle / 2);
      currentRotation += spinAmount;
      wheel.style.transform = `rotate(${currentRotation}deg)`;

      // Disable spin button while spinning
      const spinBtn = document.querySelector("button");
      spinBtn.disabled = true;
      spinBtn.style.cursor = "not-allowed";

      setTimeout(() => {
        showPopup(randomIndex);
        spinBtn.disabled = false;
        spinBtn.style.cursor = "pointer";
      }, 4200);
    }

    function showPopup(index) {
      const popup = document.getElementById("popup");
      const overlay = document.getElementById("overlay");
      const gameTitle = document.getElementById("gameTitle");
      const gameDesc = document.getElementById("gameDesc");

      gameTitle.innerText = games[index].title;
      // Replace \n with line breaks for formatting
      gameDesc.innerHTML = games[index].desc.replace(/\n/g, "<br><br>");

      overlay.style.display = "block";
      popup.style.display = "block";
      popup.focus();

      // Accessibility: set aria-hidden false
      overlay.setAttribute("aria-hidden", "false");
    }

    function closePopup() {
      const popup = document.getElementById("popup");
      const overlay = document.getElementById("overlay");
      overlay.style.display = "none";
      popup.style.display = "none";

      // Accessibility: set aria-hidden true
      overlay.setAttribute("aria-hidden", "true");
      // Return focus to spin button
      document.querySelector("button").focus();
    }

    // Close popup on ESC key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        const popup = document.getElementById("popup");
        if (popup.style.display === "block") {
          closePopup();
        }
      }
    });

    // Close popup when clicking outside it
    document.getElementById("overlay").addEventListener("click", closePopup);
  </script>
</body>
</html>