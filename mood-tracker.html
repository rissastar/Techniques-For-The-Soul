<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mood Toolkit â€” Bilingual & Animated</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
      transition: background 1s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #f0f4f8;
      color: #222;
    }
    header {
      position: relative;
      width: 90vw;
      max-width: 650px;
      text-align: center;
      padding: 20px 0;
    }
    #lang-toggle {
      position: absolute;
      top: 20px;
      right: 0;
      background: rgba(116,235,213,0.8);
      border: none;
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }
    #lang-toggle:hover { background: rgba(116,235,213,1); }

    h1 {
      font-size: 2.8rem;
      font-weight: 700;
      color: #333;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.1);
    }

    form, #mood-display, #entries-section, #word-cloud {
      background: rgba(255,255,255,0.95);
      width: 90vw;
      max-width: 650px;
      border-radius: 18px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.1);
      margin-bottom: 30px;
      padding: 25px;
      position: relative;
    }

    label {
      display: block;
      margin-top: 16px;
      font-weight: 600;
      color: #555;
      font-size: 1.05rem;
    }
    select, textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #ccc;
      border-radius: 12px;
      margin-top: 8px;
      font-size: 1rem;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    select:focus, textarea:focus {
      outline: none;
      border-color: #74ebd5;
      box-shadow: 0 0 8px rgba(116,235,213,0.6);
    }
    textarea { min-height: 100px; resize: vertical; }

    button, .action-btn {
      font-family: inherit;
      font-weight: 700;
      border: none;
      border-radius: 36px;
      padding: 14px 28px;
      margin-top: 20px;
      cursor: pointer;
      transition: background 0.3s, box-shadow 0.3s;
      user-select: none;
    }
    #save-btn {
      background: linear-gradient(45deg,#74ebd5,#ACB6E5);
      width: 100%;
      color: #1a1a2e;
    }
    #save-btn:hover {
      background: linear-gradient(45deg,#4ecdc4,#6aa8e6);
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    }
    #download-pdf { background: linear-gradient(135deg,#6a11cb,#2575fc); color: #fff; width: 48%; }
    #download-pdf:hover { background: linear-gradient(135deg,#2575fc,#6a11cb); }
    #clear-entries { background: linear-gradient(135deg,#fc5c7d,#6a82fb); color: #fff; width: 48%; }
    #clear-entries:hover { background: linear-gradient(135deg,#6a82fb,#fc5c7d); }
    #copy-share { background: #74ebd5; color: #fff; width: 100%; }
    #copy-share:hover { background: #4ecdc4; }

    /* Mood Display */
    #mood-display { min-height: 320px; text-align: center; overflow: hidden; }
    .mood-avatar {
      font-size: 6rem;
      margin-bottom: 10px;
      animation: pulse 2s infinite alternate;
      user-select: none;
    }
    @keyframes pulse { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }

    /* Sections & Flip Cards */
    .mood-section {
      background: #fff;
      border-radius: 14px;
      padding: 18px;
      margin: 16px auto;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      font-size: 1rem;
      max-width: 520px;
      cursor: pointer;
      transition: transform .3s, box-shadow .3s;
    }
    .mood-section:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 28px rgba(0,0,0,0.12);
    }
    .flip-card {
      background: transparent;
      width: 250px;
      height: 150px;
      margin: 10px;
      perspective: 1000px;
      display: inline-block;
    }
    .flip-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform .6s;
      transform-style: preserve-3d;
      border-radius: 14px;
    }
    .flip-card:hover .flip-inner { transform: rotateY(180deg); }
    .flip-front, .flip-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      font-size: 1rem;
      color: #fff;
    }
    .flip-front { background: #74ebd5; }
    .flip-back {
      background: #fff; color: #333;
      transform: rotateY(180deg);
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }

    /* Entries List */
    #entries-list {
      list-style: none;
      max-height: 300px;
      overflow-y: auto;
    }
    #entries-list li {
      padding: 14px;
      border-radius: 12px;
      background: #f7f9fa;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
      margin-bottom: 12px;
    }
    #entries-list li strong {
      display: block;
      margin-bottom: 6px;
      font-weight: 700;
    }
    #entries-list li p {
      margin: 0;
      white-space: pre-wrap;
      font-style: italic;
      color: #555e6f;
    }

    /* Word Cloud */
    #word-cloud {
      min-height: 200px;
      position: relative;
      font-family: Arial, sans-serif;
    }
    .word {
      position: absolute;
      color: rgba(0,0,0,0.2);
      white-space: nowrap;
      cursor: default;
      transition: font-size .3s, color .3s;
    }

    /* Crisis Alert */
    .crisis-alert {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: #e74c3c;
      color: #fff;
      padding: 10px 20px;
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      font-weight: 600;
    }

    /* Mood Animations */
    .anim-container {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    .drop, .spark, .ripple, .bubble, .firework, .mist, .heart-frag {
      position: absolute;
      border-radius: 50%;
      opacity: 0.8;
      pointer-events: none;
      animation: fall 4s infinite linear;
    }
    @keyframes fall {
      0% { transform: translateY(-10vh) scale(1); opacity: 0.8; }
      100% { transform: translateY(110vh) scale(0.5); opacity: 0; }
    }
    /* Mood theme backgrounds */
    body.mood-happy    { background: linear-gradient(135deg,#f6d365,#fda085); }
    body.mood-sad      { background: linear-gradient(135deg,#a1c4fd,#c2e9fb); }
    body.mood-angry    { background: linear-gradient(135deg,#f85032,#e73827); }
    body.mood-anxious  { background: linear-gradient(135deg,#f7971e,#ffd200); }
    body.mood-excited  { background: linear-gradient(135deg,#ffecd2,#fcb69f); }
    body.mood-calm     { background: linear-gradient(135deg,#89f7fe,#66a6ff); }
    body.mood-anguished { background: linear-gradient(135deg,#d299c2,#fef9d7); }
    body.mood-depressed { background: linear-gradient(135deg,#636363,#a2ab58); }

    /* Responsive */
    @media (max-width: 480px) {
      h1 { font-size: 2rem; }
      .flip-card { width: 100%; height: auto; margin: 8px 0; }
      .flip-inner { height: auto; }
      .flip-front, .flip-back { position: relative; transform: none; }
    }
  </style>
</head>
<body>

  <header>
    <h1 data-en="Mood Toolkit" data-fr="Outils Humeur">Mood Toolkit</h1>
    <button id="lang-toggle">FR</button>
  </header>

  <form id="mood-form">
    <label data-en="Select your mood:" data-fr="SÃ©lectionnez votre humeur :">Select your mood:</label>
    <select id="mood-select" required>
      <option value="" disabled selected data-en="Chooseâ€¦" data-fr="Choisissezâ€¦">Chooseâ€¦</option>
      <option value="happy"    data-en="Happy ðŸ˜Š"    data-fr="Heureux ðŸ˜Š">Happy ðŸ˜Š</option>
      <option value="sad"      data-en="Sad ðŸ˜¢"      data-fr="Triste ðŸ˜¢">Sad ðŸ˜¢</option>
      <option value="angry"    data-en="Angry ðŸ˜ "    data-fr="FÃ¢chÃ© ðŸ˜ ">Angry ðŸ˜ </option>
      <option value="anxious"  data-en="Anxious ðŸ˜Ÿ"  data-fr="Anxieux ðŸ˜Ÿ">Anxious ðŸ˜Ÿ</option>
      <option value="excited"  data-en="Excited ðŸ¤©"  data-fr="ExcitÃ© ðŸ¤©">Excited ðŸ¤©</option>
      <option value="calm"     data-en="Calm ðŸ˜Œ"     data-fr="Calme ðŸ˜Œ">Calm ðŸ˜Œ</option>
      <option value="anguished"data-en="Anguished ðŸ’”"data-fr="AngoissÃ© ðŸ’”">Anguished ðŸ’”</option>
      <option value="depressed"data-en="Depressed ðŸ˜ž"data-fr="DÃ©primÃ© ðŸ˜ž">Depressed ðŸ˜ž</option>
    </select>

    <label data-en="Add notes (optional):" data-fr="Ajoutez des notes (optionnel) :">Add notes (optional):</label>
    <textarea id="notes" placeholder="..."></textarea>

    <button type="submit" id="save-btn" data-en="Save Entry" data-fr="Enregistrer">Save Entry</button>
  </form>

  <div id="mood-display">
    <div class="anim-container"></div>
    <div class="mood-avatar"></div>
    <p data-en="Select a mood to get support below." data-fr="Choisissez une humeur pour obtenir du soutien ci-dessous.">
      Select a mood to get support below.
    </p>
  </div>

  <section id="entries-section">
    <h2 data-en="Past Entries" data-fr="EntrÃ©es PrÃ©cÃ©dentes">Past Entries</h2>
    <ul id="entries-list">
      <li data-en="No entries yet." data-fr="Aucune entrÃ©e pour le moment.">No entries yet.</li>
    </ul>
    <div style="display:flex;justify-content:space-between;flex-wrap:wrap;">
      <button id="download-pdf" data-en="Download PDF" data-fr="TÃ©lÃ©charger PDF">Download PDF</button>
      <button id="clear-entries" data-en="Clear All" data-fr="Tout effacer">Clear All</button>
    </div>
    <button id="copy-share" data-en="Copy Mood Summary" data-fr="Copier rÃ©sumÃ©">Copy Mood Summary</button>
  </section>

  <div id="word-cloud"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
  (function(){
    const langToggle = document.getElementById('lang-toggle');
    const texts = document.querySelectorAll('[data-en]');
    let lang = localStorage.getItem('lang') || 'en';

    function setLang() {
      texts.forEach(el => {
        el.textContent = el.dataset[lang];
      });
      langToggle.textContent = lang === 'en' ? 'FR' : 'EN';
      localStorage.setItem('lang', lang);
    }
    langToggle.addEventListener('click', ()=>{
      lang = lang === 'en' ? 'fr' : 'en';
      setLang();
    });
    setLang();

    const moodData = {
      happy:    { avatar:'ðŸ˜Š', en:{coping:'Share a smile or dive into a fun hobby.', reflect:'What made you happy today?', tip:'Keep the joy going!' }, fr:{coping:'Partagez un sourire ou pratiquez un passe-temps amusant.', reflect:'Quâ€™est-ce qui vous a rendu heureux aujourdâ€™hui ?', tip:'Continuez Ã  cultiver la joie !'} },
      sad:      { avatar:'ðŸ˜¢', en:{coping:'Talk with someone or write about it.', reflect:'What helped or hurt you today?', tip:'Allow yourself to feel and heal.' }, fr:{coping:'Parlez Ã  quelquâ€™un ou Ã©crivez Ã  ce sujet.', reflect:'Quâ€™est-ce qui vous a aidÃ© ou blessÃ© aujourdâ€™hui ?', tip:'Autorisez-vous Ã  ressentir et guÃ©rir .'} },
      angry:    { avatar:'ðŸ˜ ', en:{coping:'Try deep breaths or a brisk walk.', reflect:'What triggered your anger?', tip:'Channel it into something positive.' }, fr:{coping:'Essayez la respiration profonde ou une marche rapide.', reflect:'Quâ€™est-ce qui a dÃ©clenchÃ© votre colÃ¨re ?', tip:'Canalisez-la en quelque chose de positif .'} },
      anxious:  { avatar:'ðŸ˜Ÿ', en:{coping:'Ground yourself by naming 5 things you see.', reflect:'What exactly worries you?', tip:'Return to the present moment.' }, fr:{coping:'Ancrez-vous en nommant 5 choses que vous voyez.', reflect:'Quâ€™est-ce qui vous inquiÃ¨te exactement ?', tip:'Revenez au moment prÃ©sent .'} },
      excited:  { avatar:'ðŸ¤©', en:{coping:'Channel energy: plan something creative.', reflect:'What are you excited about?', tip:'Use it to fuel productivity.' }, fr:{coping:'Canalisez lâ€™Ã©nergie : planifiez quelque chose de crÃ©atif.', reflect:'Quâ€™est-ce qui vous enthousiasme ?', tip:'Utilisez-le pour stimuler votre productivitÃ© .'} },
      calm:     { avatar:'ðŸ˜Œ', en:{coping:'Enjoy nature or meditate.', reflect:'What helps you stay calm?', tip:'Savor this peace.' }, fr:{coping:'Profitez de la nature ou mÃ©ditez.', reflect:'Quâ€™est-ce qui vous aide Ã  rester calme ?', tip:'Savourez cette paix .'} },
      anguished:{ avatar:'ðŸ’”',en:{coping:'Reach out for helpâ€”this feels serious.', reflect:'When did you feel this first?', tip:'You donâ€™t have to face this alone.' }, fr:{coping:'Demandez de lâ€™aide â€“ câ€™est sÃ©rieux.', reflect:'Quand avez-vous ressenti cela pour la premiÃ¨re fois ?', tip:'Vous nâ€™Ãªtes pas seul .'} },
      depressed:{ avatar:'ðŸ˜ž',en:{coping:'Consider talking to a professional.', reflect:'What small step can you take?', tip:'Start with something gentle.' }, fr:{coping:'Envisagez de parler Ã  un professionnel.', reflect:'Quelle petite Ã©tape pouvez-vous faire ?', tip:'Commencez par quelque chose de doux .'} }
    };

    const form = document.getElementById('mood-form');
    const moodSelect = document.getElementById('mood-select');
    const notesInput = document.getElementById('notes');
    const display = document.getElementById('mood-display');
    const list = document.getElementById('entries-list');
    const dlPDF = document.getElementById('download-pdf');
    const clrBtn = document.getElementById('clear-entries');
    const copyBtn = document.getElementById('copy-share');
    const wordCloud = document.getElementById('word-cloud');
    const animContainer = document.querySelector('.anim-container');
    let entries = JSON.parse(localStorage.getItem('moodEntries')||'[]');

    function isCrisis(m) { return ['anguished','depressed'].includes(m); }

    function clearAnimations() { animContainer.innerHTML = ''; }
    function addAnimations(m) {
      clearAnimations();
      const count = 30;
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.classList.add(
          m==='happy'    ? 'spark' :
          m==='sad'      ? 'drop'  :
          m==='angry'    ? 'ripple':
          m==='anxious'  ? 'mist'  :
          m==='excited'  ? 'firework':
          m==='calm'     ? 'bubble':
          m==='anguished'? 'heart-frag':
          m==='depressed'? 'mist': 'spark'
        );
        el.style.left = Math.random()*100+'%';
        el.style.animationDuration = (3+Math.random()*3)+'s';
        el.style.width = el.style.height = (5+Math.random()*10)+'px';
        if(el.classList.contains('heart-frag')){
          el.style.background = 'rgba(231,76,60,0.8)';
        } else if(el.classList.contains('drop')){
          el.style.background = 'rgba(52,152,219,0.6)';
        } else if(el.classList.contains('spark')){
          el.style.background = 'rgba(241,196,15,0.8)';
        } else if(el.classList.contains('ripple')){
          el.style.border = '2px solid rgba(231,76,60,0.8)';
          el.style.background = 'transparent';
        } else if(el.classList.contains('mist')){
          el.style.background = 'rgba(149,165,166,0.4)';
        } else if(el.classList.contains('firework')){
          el.style.background = `hsl(${Math.random()*360},80%,60%)`;
        } else if(el.classList.contains('bubble')){
          el.style.background = 'rgba(135,206,235,0.5)';
        }
        animContainer.appendChild(el);
      }
    }

    function renderDisplay(m) {
      display.querySelector('p')?.remove();
      display.querySelector('.mood-avatar').textContent = '';
      display.querySelector('.crisis-alert')?.remove();
      display.querySelectorAll('.mood-section, .flip-card').forEach(e=>e.remove());
      clearAnimations();
      if(!m) {
        const p = document.createElement('p');
        p.dataset.en = p.dataset.fr = '';
        p.textContent = texts[0]?.dataset.en || 'Select a mood to get support below.';
        display.appendChild(p);
        return;
      }
      const md = moodData[m];
      const t  = md[lang];
      display.querySelector('.mood-avatar').textContent = md.avatar;
      if(isCrisis(m)){
        const alert = document.createElement('div');
        alert.className = 'crisis-alert';
        alert.textContent = lang==='en'?'Urgent support suggested':'Un soutien urgent est suggÃ©rÃ©';
        display.appendChild(alert);
      }
      addAnimations(m);

      // Coping Section
      const cope = document.createElement('div');
      cope.className = 'mood-section';
      cope.textContent = t.coping;
      display.appendChild(cope);

      // Flip cards: Reflection & Tip
      ['reflect','tip'].forEach(key=>{
        const front = document.createElement('div'),
              back  = document.createElement('div'),
              inner = document.createElement('div'),
              card  = document.createElement('div');
        card.className = 'flip-card';
        inner.className = 'flip-inner';
        front.className = 'flip-front';
        back.className = 'flip-back';
        front.textContent = key === 'reflect'
          ? (lang==='en'?'Reflection':'RÃ©flexion')
          : (lang==='en'?'Tip':'Conseil');
        back.textContent = t[key];
        inner.appendChild(front);
        inner.appendChild(back);
        card.appendChild(inner);
        display.appendChild(card);
      });
    }

    function renderEntries() {
      list.innerHTML = '';
      if(!entries.length) {
        const li = document.createElement('li');
        li.textContent = lang==='en'?'No entries yet.':'Aucune entrÃ©e pour le moment.';
        list.appendChild(li);
        return;
      }
      entries.forEach(e=>{
        const li = document.createElement('li');
        const md = moodData[e.mood];
        const dt = new Date(e.date).toLocaleString(lang==='en'?'en-US':'fr-FR');
        li.innerHTML = `<strong>${md.avatar} ${e.mood.charAt(0).toUpperCase()+e.mood.slice(1)} â€“ ${dt}</strong>
                        <p>${e.notes|| (lang==='en'? 'No notes':'Pas de notes')}</p>
                        <p><em>${lang==='en'?'Reflection':'RÃ©flexion'}: ${e.reflect|| '-'}</em></p>`;
        list.appendChild(li);
      });
    }

    function updateWordCloud() {
      wordCloud.innerHTML = '';
      const text = entries.map(e=>e.notes).join(' ');
      const freq = {};
      text.split(/\W+/).filter(w=>w.length>3).forEach(w=>{
        const key = w.toLowerCase();
        freq[key] = (freq[key]||0)+1;
      });
      Object.entries(freq)
        .sort((a,b)=>b[1]-a[1])
        .slice(0,30)
        .forEach(([w,c])=>{
          const span = document.createElement('span');
          const size = 14 + c*4;
          span.className = 'word';
          span.textContent = w;
          span.style.fontSize = size+'px';
          span.style.left = (Math.random()*80)+'%';
          span.style.top  = (Math.random()*80)+'%';
          wordCloud.appendChild(span);
        });
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const m = moodSelect.value;
      const n = notesInput.value.trim();
      if(!m) return;
      // render first to extract reflection text
      renderDisplay(m);
      const reflectText = display.querySelector('.flip-back')?.textContent || '';
      entries.unshift({ mood:m, notes:n, date:new Date().toISOString(), reflect:reflectText });
      localStorage.setItem('moodEntries', JSON.stringify(entries));
      moodSelect.value = '';
      notesInput.value = '';
      renderDisplay(m);
      renderEntries();
      updateWordCloud();
    });

    clrBtn.addEventListener('click', ()=>{
      if(confirm(lang==='en'?'Clear all entries?':'Tout effacer ?')){
        entries = [];
        localStorage.setItem('moodEntries','[]');
        renderEntries();
        renderDisplay(null);
        updateWordCloud();
      }
    });

    dlPDF.addEventListener('click', ()=>{
      if(!entries.length) return alert(lang==='en'?'No entries to download':'Aucune entrÃ©e Ã  tÃ©lÃ©charger');
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 20;
      doc.setFontSize(18);
      doc.text(lang==='en'?'Mood Journal':'Journal Humeur',105,10,{ align:'center' });
      doc.setFontSize(12);
      entries.forEach(e=>{
        if(y>270){ doc.addPage(); y=20; }
        const md = moodData[e.mood];
        const dt = new Date(e.date).toLocaleString(lang==='en'?'en-US':'fr-FR');
        doc.text(`${md.avatar} ${e.mood.charAt(0).toUpperCase()+e.mood.slice(1)}, ${dt}`,10,y);
        y += 8;
        doc.text((lang==='en'?'Notes':'Notes')+': '+(e.notes||'-'),10,y);
        y += 8;
        doc.text((lang==='en'?'Reflection':'RÃ©flexion')+': '+(e.reflect||'-'),10,y);
        y += 12;
      });
      doc.save('mood-journal.pdf');
    });

    copyBtn.addEventListener('click', ()=>{
      if(!entries.length) return alert(lang==='en'?'No entries to copy':'Rien Ã  copier');
      const last = entries[0];
      const md = moodData[last.mood];
      const dt = new Date(last.date).toLocaleDateString(lang==='en'?'en-US':'fr-FR');
      const summary = `${md.avatar} ${last.mood.charAt(0).toUpperCase()+last.mood.slice(1)} â€“ ${dt}\n${last.notes}`;
      navigator.clipboard.writeText(summary).then(()=>
        alert(lang==='en'?'Copied!':'CopiÃ© !')
      );
    });

    // Initialize
    renderDisplay(null);
    renderEntries();
    updateWordCloud();
  })();
  </script>

</body>
</html>