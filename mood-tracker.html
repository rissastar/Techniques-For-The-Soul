<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mood Toolkit â€” Polished & Animated</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
  * {
    box-sizing: border-box;
    margin: 0; padding: 0;
  }
  body {
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
    transition: background 1s ease;
    background: #f9fafb;
    padding: 20px 10px 40px;
  }
  header {
    position: relative;
    width: 90vw;
    max-width: 650px;
    text-align: center;
    padding: 24px 0 12px;
    user-select: none;
  }
  #lang-toggle {
    position: absolute;
    top: 20px;
    right: 0;
    background: #74ebd5;
    border: none;
    padding: 8px 18px;
    border-radius: 24px;
    font-weight: 600;
    color: #1a1a2e;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(116, 235, 213, 0.5);
    transition: background-color 0.3s ease, transform 0.2s ease;
    z-index: 10;
  }
  #lang-toggle:hover {
    background: #3bd9c5;
    transform: scale(1.05);
  }
  h1 {
    font-size: 3rem;
    font-weight: 700;
    color: #1a1a2e;
    text-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  form, #mood-display, #entries-section, #word-cloud {
    background: rgba(255, 255, 255, 0.97);
    width: 90vw;
    max-width: 650px;
    border-radius: 22px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.07);
    margin-bottom: 32px;
    padding: 28px 30px 36px;
    position: relative;
  }
  label {
    display: block;
    margin-top: 20px;
    font-weight: 600;
    color: #444;
    font-size: 1.1rem;
  }
  select, textarea {
    width: 100%;
    padding: 14px 16px;
    border: 2.5px solid #cce7e4;
    border-radius: 16px;
    margin-top: 10px;
    font-size: 1rem;
    font-family: 'Poppins', sans-serif;
    resize: vertical;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }
  select:focus, textarea:focus {
    outline: none;
    border-color: #74ebd5;
    box-shadow: 0 0 12px rgba(116, 235, 213, 0.7);
  }
  textarea {
    min-height: 90px;
    font-size: 1rem;
  }
  button, .action-btn {
    font-weight: 700;
    border: none;
    border-radius: 40px;
    padding: 16px 34px;
    margin-top: 28px;
    cursor: pointer;
    transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
    user-select: none;
  }
  button:hover, .action-btn:hover {
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
    transform: translateY(-2px);
  }
  #save-btn {
    background: linear-gradient(45deg, #74ebd5, #ACB6E5);
    width: 100%;
    color: #1a1a2e;
    font-size: 1.2rem;
  }
  #download-pdf, #clear-entries {
    width: 48%;
    font-size: 1rem;
    color: white;
  }
  #download-pdf {
    background: linear-gradient(135deg, #6a11cb, #2575fc);
  }
  #clear-entries {
    background: linear-gradient(135deg, #fc5c7d, #6a82fb);
  }
  #copy-share {
    background: #74ebd5;
    color: white;
    width: 100%;
    font-size: 1rem;
    margin-top: 12px;
  }
  #mood-display {
    min-height: 360px;
    text-align: center;
    overflow: hidden;
    padding-top: 40px;
  }
  .mood-avatar {
    font-size: 7rem;
    margin-bottom: 18px;
    animation: pulse 2.5s ease-in-out infinite alternate;
    filter: drop-shadow(0 0 5px rgba(116, 235, 213, 0.7));
  }
  @keyframes pulse {
    0% { transform: scale(1); filter: drop-shadow(0 0 5px rgba(116, 235, 213, 0.7)); }
    100% { transform: scale(1.12); filter: drop-shadow(0 0 18px rgba(116, 235, 213, 0.9)); }
  }
  .crisis-alert {
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    background: #e74c3c;
    color: #fff;
    padding: 12px 28px;
    border-radius: 28px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    font-weight: 700;
    font-size: 1.1rem;
    letter-spacing: 0.04em;
    z-index: 6;
    user-select: none;
  }
  .mood-section {
    background: #fff;
    border-radius: 18px;
    padding: 24px;
    margin: 20px auto 30px;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
    font-size: 1.05rem;
    max-width: 540px;
    cursor: default;
    color: #222;
    line-height: 1.48;
    user-select: text;
  }
  .flip-card {
    background: transparent;
    width: 270px;
    height: 160px;
    margin: 14px 10px;
    perspective: 1100px;
    display: inline-block;
    vertical-align: top;
    cursor: pointer;
  }
  .flip-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.7s cubic-bezier(0.2, 0.6, 0.2, 1);
    transform-style: preserve-3d;
    border-radius: 18px;
    box-shadow: 0 14px 35px rgba(0,0,0,0.15);
  }
  .flip-card:hover .flip-inner {
    transform: rotateY(180deg);
  }
  .flip-front, .flip-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 18px 28px;
    font-size: 1.15rem;
    font-weight: 600;
    text-align: center;
    user-select: none;
  }
  .flip-front {
    background: #74ebd5;
    color: #fff;
    box-shadow: inset 0 0 40px rgba(255, 255, 255, 0.2);
    letter-spacing: 0.05em;
    text-transform: uppercase;
  }
  .flip-back {
    background: #fefefe;
    color: #333;
    transform: rotateY(180deg);
    font-weight: 500;
    line-height: 1.4;
    user-select: text;
  }
  #entries-list {
    list-style: none;
    max-height: 320px;
    overflow-y: auto;
    padding-left: 0;
  }
  #entries-list li {
    padding: 16px 20px;
    border-radius: 18px;
    background: #f0f6f5;
    box-shadow: inset 0 3px 8px rgba(0, 0, 0, 0.07);
    margin-bottom: 18px;
    font-size: 1rem;
    color: #444;
    line-height: 1.45;
    user-select: text;
  }
  #entries-list li strong {
    display: block;
    margin-bottom: 8px;
    font-weight: 700;
    color: #1a1a2e;
    font-size: 1.1rem;
  }
  #entries-section > div {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 14px;
    margin-top: 12px;
  }
  #word-cloud {
    position: relative;
    min-height: 220px;
    border-radius: 28px;
    box-shadow: 0 14px 40px rgba(0,0,0,0.09);
    padding: 28px;
    font-family: 'Poppins', sans-serif;
    overflow: hidden;
  }
  .word {
    position: absolute;
    color: rgba(0,0,0,0.22);
    white-space: nowrap;
    cursor: default;
    transition: font-size 0.3s ease, color 0.3s ease, transform 0.3s ease;
    font-weight: 600;
    user-select: none;
  }
  .word:hover {
    color: rgba(116, 235, 213, 0.8);
    transform: scale(1.25);
    z-index: 10;
  }
  /* Animations containers */
  .anim-container {
    pointer-events: none;
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    overflow: hidden;
    z-index: 1;
    border-radius: 22px;
  }
  .anim-item {
    position: absolute;
    border-radius: 50%;
    opacity: 0.7;
    animation: fall infinite linear;
    background: #ffffffcc;
  }
  @keyframes fall {
    0% {
      transform: translateY(-15vh) scale(0.5);
      opacity: 1;
    }
    100% {
      transform: translateY(110vh) scale(1);
      opacity: 0;
    }
  }
  /* Mood gradients */
  body.mood-happy {background: linear-gradient(135deg, #f6d365, #fda085);}
  body.mood-sad {background: linear-gradient(135deg, #667eea, #764ba2);}
  body.mood-angry {background: linear-gradient(135deg, #f85032, #e73827);}
  body.mood-anxious {background: linear-gradient(135deg, #f7971e, #ffd200);}
  body.mood-excited {background: linear-gradient(135deg, #fcb045, #fd1d1d, #833ab4);}
  body.mood-calm {background: linear-gradient(135deg, #96fbc4, #f9f586);}
  body.mood-anguished {background: linear-gradient(135deg, #e52d27, #b31217);}
  body.mood-depressed {background: linear-gradient(135deg, #3a1c71, #d76d77, #ffaf7b);}
  /* Responsive */
  @media (max-width: 700px) {
    #mood-display {
      min-height: 300px;
      padding-top: 32px;
    }
    .flip-card {
      width: 100%;
      max-width: 280px;
      height: 150px;
      margin: 14px auto;
      display: block;
    }
    #entries-section > div {
      flex-direction: column;
    }
    #download-pdf, #clear-entries {
      width: 100% !important;
    }
  }
</style>
</head>
<body>
  <header>
    <h1 data-en="Mood Toolkit" data-fr="Outils Humeur">Mood Toolkit</h1>
    <button id="lang-toggle">FR</button>
  </header>

  <form id="mood-form" autocomplete="off">
    <label data-en="Select your mood:" data-fr="SÃ©lectionnez votre humeur :">Select your mood:</label>
    <select id="mood-select" required>
      <option value="" disabled selected data-en="Chooseâ€¦" data-fr="Choisissezâ€¦">Chooseâ€¦</option>
      <option value="happy" data-en="Happy ðŸ˜Š" data-fr="Heureux ðŸ˜Š">Happy ðŸ˜Š</option>
      <option value="sad" data-en="Sad ðŸ˜¢" data-fr="Triste ðŸ˜¢">Sad ðŸ˜¢</option>
      <option value="angry" data-en="Angry ðŸ˜ " data-fr="FÃ¢chÃ© ðŸ˜ ">Angry ðŸ˜ </option>
      <option value="anxious" data-en="Anxious ðŸ˜Ÿ" data-fr="Anxieux ðŸ˜Ÿ">Anxious ðŸ˜Ÿ</option>
      <option value="excited" data-en="Excited ðŸ¤©" data-fr="ExcitÃ© ðŸ¤©">Excited ðŸ¤©</option>
      <option value="calm" data-en="Calm ðŸ˜Œ" data-fr="Calme ðŸ˜Œ">Calm ðŸ˜Œ</option>
      <option value="anguished" data-en="Anguished ðŸ’”" data-fr="AngoissÃ© ðŸ’”">Anguished ðŸ’”</option>
      <option value="depressed" data-en="Depressed ðŸ˜ž" data-fr="DÃ©primÃ© ðŸ˜ž">Depressed ðŸ˜ž</option>
    </select>

    <label data-en="Add notes (optional):" data-fr="Ajoutez des notes (optionnel) :">Add notes (optional):</label>
    <textarea id="notes" placeholder="..."></textarea>

    <button type="submit" id="save-btn" data-en="Save Entry" data-fr="Enregistrer">Save Entry</button>
  </form>

  <div id="mood-display">
    <div class="anim-container" id="anim-bg"></div>
    <div class="mood-avatar"></div>
    <p data-en="Select a mood to get support below." data-fr="Choisissez une humeur pour obtenir du soutien ci-dessous.">
      Select a mood to get support below.
    </p>
  </div>

  <section id="entries-section">
    <h2 data-en="Past Entries" data-fr="EntrÃ©es PrÃ©cÃ©dentes">Past Entries</h2>
    <ul id="entries-list">
      <li data-en="No entries yet." data-fr="Aucune entrÃ©e pour le moment.">No entries yet.</li>
    </ul>
    <div>
      <button id="download-pdf">Download PDF</button>
      <button id="clear-entries" data-en="Clear All" data-fr="Tout effacer">Clear All</button>
    </div>
    <button id="copy-share" data-en="Copy Mood Summary" data-fr="Copier rÃ©sumÃ©">Copy Mood Summary</button>
  </section>

  <div id="word-cloud" aria-label="Word Cloud"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    (function(){
      // Language toggle
      const langToggle = document.getElementById('lang-toggle'),
            texts = document.querySelectorAll('[data-en]');
      let lang = localStorage.lang || 'en';
      const setLang = () => {
        texts.forEach(el => el.textContent = el.dataset[lang]);
        langToggle.textContent = lang==='en'?'FR':'EN';
        localStorage.lang = lang;
      };
      langToggle.onclick = () => { lang = lang==='en'?'fr':'en'; setLang(); };
      setLang();

      // Mood data
      const moodData = {
        happy:     { avatar:'ðŸ˜Š', anima:'sunburst', en:{coping:'Share a smile or dive into a fun hobby.',reflect:'What made you happy today?',tip:'Keep the joy going!'}, fr:{coping:'Partagez votre sourire ou plongez dans un passe-temps amusant.',reflect:'Quâ€™est-ce qui vous a rendu heureux aujourdâ€™hui?',tip:'Continuez Ã  cultiver la joie !'} },
        sad:       { avatar:'ðŸ˜¢', anima:'raindrop', en:{coping:'Talk with someone or write about it.',reflect:'What helped or hurt you today?',tip:'Allow yourself to feel and heal.'}, fr:{coping:'Parlez Ã  quelquâ€™un ou Ã©crivez Ã  ce sujet.',reflect:'Quâ€™est-ce qui vous a aidÃ© ou blessÃ© aujourdâ€™hui?',tip:'Autorisez-vous Ã  ressentir et guÃ©rir.'} },
        angry:     { avatar:'ðŸ˜ ', anima:'ripple', en:{coping:'Try deep breaths or a brisk walk.',reflect:'What triggered your anger?',tip:'Channel it into something positive.'}, fr:{coping:'Essayez la respiration profonde ou une marche rapide.',reflect:'Quâ€™est-ce qui a dÃ©clenchÃ© votre colÃ¨re?',tip:'Canalisez-la en quelque chose de positif.'} },
        anxious:   { avatar:'ðŸ˜Ÿ', anima:'shaky', en:{coping:'Use grounding: name 5 things you see.',reflect:'What exactly worries you?',tip:'Return to the present moment.'}, fr:{coping:'Utilisez lâ€™ancrage : nommez 5 choses que vous voyez.',reflect:'Quâ€™est-ce qui vous inquiÃ¨te exactement?',tip:'Revenez au moment prÃ©sent.'} },
        excited:   { avatar:'ðŸ¤©', anima:'firework', en:{coping:'Channel energy: plan something creative.',reflect:'What are you excited about?',tip:'Use it to fuel productivity.'}, fr:{coping:'Canalisez lâ€™Ã©nergie : planifiez quelque chose de crÃ©atif.',reflect:'Quâ€™est-ce qui vous enthousiasme?',tip:'Utilisez-le pour stimuler votre productivitÃ©.'} },
        calm:      { avatar:'ðŸ˜Œ', anima:'bubble', en:{coping:'Enjoy nature or meditate.',reflect:'What helps you stay calm?',tip:'Savor this peace.'}, fr:{coping:'Profitez de la nature ou mÃ©diter.',reflect:'Quâ€™est-ce qui vous aide Ã  rester calme?',tip:'Savourez cette paix.'} },
        anguished: { avatar:'ðŸ’”', anima:'shatter', en:{coping:'Reach out for helpâ€”this sounds serious.',reflect:'When did you feel this way first?',tip:'You do not have to face this alone.'}, fr:{coping:'Demandez de lâ€™aide â€“ cela semble sÃ©rieux.',reflect:'Quand avez-vous ressenti cela pour la premiÃ¨re fois?',tip:'Vous nâ€™Ãªtes pas seul.'} },
        depressed: { avatar:'ðŸ˜ž', anima:'mist', en:{coping:'Consider talking to a professional.',reflect:'What is one small step you can take?',tip:'Start with something gentle.'}, fr:{coping:'Envisagez de parler Ã  un professionnel.',reflect:'Quelle est la petite Ã©tape que vous pouvez faire?',tip:'Commencez par quelque chose de doux.'} }
      };

      // Elements
      const form = document.getElementById('mood-form'),
            moodSelect = document.getElementById('mood-select'),
            notesInput = document.getElementById('notes'),
            display = document.getElementById('mood-display'),
            animBg = document.getElementById('anim-bg'),
            avatarEl = document.querySelector('.mood-avatar'),
            list = document.getElementById('entries-list'),
            dlPDF = document.getElementById('download-pdf'),
            clrBtn = document.getElementById('clear-entries'),
            copyBtn = document.getElementById('copy-share'),
            wordCloud = document.getElementById('word-cloud');

      let entries = JSON.parse(localStorage.getItem('moodEntries')) || [];

      // Helpers
      const clearAnim = () => { animBg.innerHTML = ''; };
      const createAnim = (type) => {
        clearAnim();
        const count = 30;
        for(let i=0; i<count; i++){
          const el = document.createElement('div');
          el.className = 'anim-item';
          const size = Math.random()*8+6;
          el.style.width = el.style.height = size + 'px';
          el.style.left = (Math.random()*100) + '%';
          el.style.background = '#fff';
          el.style.animationDuration = (Math.random()*3+3) + 's';
          el.style.animationDelay = (Math.random()*5) + 's';
          animBg.appendChild(el);
        }
      };
      const crisisCheck = m => ['anguished','depressed'].includes(m);
      const capitalize = s => s.charAt(0).toUpperCase() + s.slice(1);

      // Display update
      function updateDisplay(key){
        document.body.className = key ? ('mood-'+key) : '';
        clearAnim();
        display.querySelectorAll('.mood-section, .flip-card, .crisis-alert, p').forEach(el => el.remove());
        avatarEl.textContent = '';
        if(!key){
          avatarEl.textContent = '';
          const p = document.createElement('p');
          p.textContent = document.querySelector('[data-en="Select a mood to get support below."]').dataset[lang];
          display.appendChild(p);
          return;
        }
        const md = moodData[key], txt = md[lang];
        // Animation
        createAnim(md.anima);
        // Crisis alert
        if(crisisCheck(key)){
          const ca = document.createElement('div');
          ca.className='crisis-alert';
          ca.textContent = lang==='en' ? 'Urgent support suggested' : 'Un soutien urgent est suggÃ©rÃ©';
          display.appendChild(ca);
        }
        // Avatar with mood color glow
        avatarEl.textContent = md.avatar;
        avatarEl.style.filter = 'drop-shadow(0 0 15px rgba(116,235,213,0.9))';
        // Coping section
        const cope = document.createElement('div');
        cope.className = 'mood-section';
        cope.textContent = txt.coping;
        display.appendChild(cope);
        // Flip cards for Reflection and Tip
        ['reflect','tip'].forEach(fld=>{
          const card = document.createElement('div');
          const inner = document.createElement('div');
          const front = document.createElement('div');
          const back = document.createElement('div');
          card.className = 'flip-card';
          inner.className = 'flip-inner';
          front.className = 'flip-front';
          back.className = 'flip-back';
          front.textContent = fld === 'reflect' ? (lang === 'en' ? 'Reflection' : 'RÃ©flexion') : (lang === 'en' ? 'Tip' : 'Conseil');
          back.textContent = txt[fld];
          inner.append(front, back);
          card.appendChild(inner);
          display.appendChild(card);
        });
      }

      // Render past entries list
      function renderEntries(){
        list.innerHTML = '';
        if(!entries.length){
          const li = document.createElement('li');
          li.textContent = document.querySelector('[data-en="No entries yet."]').dataset[lang];
          list.appendChild(li);
          return;
        }
        entries.forEach(e=>{
          const li = document.createElement('li');
          const md = moodData[e.mood];
          li.innerHTML = `<strong>${md.avatar} ${capitalize(e.mood)} â€“ ${new Date(e.date).toLocaleString()}</strong>
                          <p>${e.notes || '-'}</p>
                          <p><em>${lang === 'en' ? 'Reflection' : 'RÃ©flexion'}: ${e.reflect || '-'}</em></p>`;
          list.appendChild(li);
        });
      }

      // Word cloud generator
      function updateWordCloud(){
        wordCloud.innerHTML = '';
        const text = entries.map(e => e.notes).join(' ');
        const words = text.split(/\W+/).filter(w => w.length > 3);
        if(words.length === 0) return;
        const freq = {};
        words.forEach(w => freq[w] = (freq[w] || 0) + 1);
        Object.entries(freq).sort((a,b) => b[1] - a[1]).slice(0, 30).forEach(([w,c]) => {
          const span = document.createElement('span');
          const size = 12 + c * 4;
          span.className = 'word';
          span.textContent = w;
          span.style.fontSize = size + 'px';
          span.style.left = Math.random() * 85 + '%';
          span.style.top = Math.random() * 75 + '%';
          span.style.color = `rgba(0, 0, 0, ${0.15 + c * 0.06})`;
          wordCloud.appendChild(span);
        });
      }

      // Form submit
      form.onsubmit = e => {
        e.preventDefault();
        const m = moodSelect.value, n = notesInput.value.trim();
        if(!m) return;
        const reflectTxt = display.querySelector('.flip-back')?.textContent || '';
        entries.unshift({mood:m,notes:n,date:new Date().toISOString(),reflect:reflectTxt});
        localStorage.moodEntries = JSON.stringify(entries);
        notesInput.value = '';
        moodSelect.value = '';
        updateDisplay(m);
        renderEntries();
        updateWordCloud();
      };

      // Clear all entries
      clrBtn.onclick = () => {
        if(confirm(lang === 'en' ? 'Clear all entries?' : 'Tout effacer ?')){
          entries = [];
          localStorage.moodEntries = '[]';
          renderEntries();
          updateDisplay(null);
          updateWordCloud();
        }
      };

      // Download PDF using jsPDF
      dlPDF.onclick = () => {
        if(!entries.length) return alert(lang === 'en' ? 'No entries to download' : 'Aucune entrÃ©e Ã  tÃ©lÃ©charger');
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let y = 25;
        doc.setFontSize(20);
        doc.text(lang === 'en' ? 'Mood Journal' : 'Journal Humeur', 105, 15, {align: 'center'});
        doc.setFontSize(12);
        entries.forEach(e => {
          if(y > 275){
            doc.addPage();
            y = 25;
          }
          const md = moodData[e.mood];
          doc.text(`${md.avatar} ${capitalize(e.mood)} â€“ ${new Date(e.date).toLocaleString()}`, 14, y);
          y += 9;
          doc.text((lang === 'en' ? 'Notes' : 'Notes') + ': ' + (e.notes || '-'), 14, y);
          y += 9;
          doc.text((lang === 'en' ? 'Reflection' : 'RÃ©flexion') + ': ' + (e.reflect || '-'), 14, y);
          y += 14;
        });
        doc.save('mood-journal.pdf');
      };

      // Copy last mood summary to clipboard
      copyBtn.onclick = () => {
        if(!entries.length) return alert(lang === 'en' ? 'No entries to copy' : 'Rien Ã  copier');
        const last = entries[0];
        const summary = `${capitalize(last.mood)} â€¢ ${new Date(last.date).toLocaleDateString()}\n${last.notes || ''}`;
        navigator.clipboard.writeText(summary).then(() => alert(lang === 'en' ? 'Copied!' : 'CopiÃ© !'));
      };

      // Initialize
      updateDisplay(null);
      renderEntries();
      updateWordCloud();
    })();
  </script>
</body>
</html>