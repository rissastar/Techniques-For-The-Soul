<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mood Toolkit â€” Bilingual & Enhanced</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Poppins',sans-serif;min-height:100vh;background:#f0f4f8;color:#222;display:flex;flex-direction:column;align-items:center;transition:background 1s;}
  header{position:relative;width:90vw;max-width:650px;text-align:center;padding:20px 0;}
  #lang-toggle{position:absolute;top:20px;right:0;background:#ddd;border:none;padding:6px 12px;border-radius:20px;cursor:pointer;}
  h1{font-size:2.8rem;font-weight:700;color:#333;text-shadow:1px 1px 4px rgba(0,0,0,0.1);}
  form,mood-display,entries-section{background:rgba(255,255,255,0.95);width:90vw;max-width:650px;border-radius:18px;box-shadow:0 8px 30px rgba(0,0,0,0.1);margin-bottom:30px;padding:25px;}
  label{display:block;margin-top:16px;font-weight:600;color:#555;font-size:1.05rem;}
  select,textarea{width:100%;padding:12px;border:2px solid #ccc;border-radius:12px;margin-top:8px;font-size:1rem;transition:0.3s;border-color:#74ebd5 onfocus;}
  select:focus,textarea:focus{outline:none;border-color:#74ebd5;box-shadow:0 0 8px rgba(116,235,213,0.6);}
  button, .action-btn{font-weight:700;border:none;border-radius:36px;padding:14px 28px;margin-top:20px;cursor:pointer;transition:background 0.3s,box-shadow 0.3s;}
  button:hover, .action-btn:hover{box-shadow:0 6px 18px rgba(0,0,0,0.15);}
  #save-btn{background:linear-gradient(45deg,#74ebd5,#ACB6E5);width:100%;}
  #download-pdf{background:linear-gradient(135deg,#6a11cb,#2575fc);color:#fff;width:48%;}
  #clear-entries{background:linear-gradient(135deg,#fc5c7d,#6a82fb);color:#fff;width:48%;}
  #copy-share{background:#74ebd5;color:#fff;width:100%;margin-top:10px;}
  #mood-display{min-height:300px;text-align:center;position:relative;}
  .mood-avatar{font-size:6rem;margin-bottom:10px;animation:pulse 2s infinite alternate;}
  @keyframes pulse{0%{transform:scale(1);}100%{transform:scale(1.1);}}
  .mood-section{background:#fff;border-radius:14px;padding:18px;margin:16px auto;box-shadow:0 6px 20px rgba(0,0,0,0.08);font-size:1rem;max-width:520px;cursor:pointer;transition:transform .3s;}
  .mood-section:hover{transform:translateY(-6px);}
  .flip-card{background:#fff;width:250px;height:150px;margin:10px;perspective:1000px;display:inline-block;}
  .flip-inner{position:relative;width:100%;height:100%;transition:transform .6s;transform-style:preserve-3d;}
  .flip-card:hover .flip-inner{transform:rotateY(180deg);}
  .flip-front,.flip-back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:14px;display:flex;align-items:center;justify-content:center;padding:10px;box-shadow:0 6px 20px rgba(0,0,0,0.08);font-size:1rem;text-align:center;}
  .flip-front{background:#74ebd5;color:#fff;}
  .flip-back{background:#fff;color:#333;transform:rotateY(180deg);}
  #entries-list{list-style:none;max-height:300px;overflow-y:auto;}
  #entries-list li{padding:14px;border-radius:12px;background:#f7f9fa;box-shadow:inset 0 2px 6px rgba(0,0,0,0.05);margin-bottom:12px;}
  #entries-list li strong{display:block;margin-bottom:6px;font-weight:700;}
  #word-cloud{width:90vw;max-width:650px;min-height:200px;background:#fff;border-radius:18px;box-shadow:0 8px 30px rgba(0,0,0,0.1);padding:20px;margin-bottom:30px;position:relative;font-family:Arial, sans-serif;}
  .word{position:absolute;color:rgba(0,0,0,0.2);white-space:nowrap;cursor:default;transition:font-size .3s,color .3s;}
  /* Mood themes & crisis */
  body.mood-anguished,body.mood-angry,body.mood-depressed{--crisis:1;}
  .crisis-alert{position:absolute;top:10px;left:50%;transform:translateX(-50%);background:#e74c3c;color:#fff;padding:10px 20px;border-radius:20px;box-shadow:0 4px 15px rgba(0,0,0,0.2);}
</style>
</head>
<body>
<header>
  <h1 data-en="Mood Toolkit" data-fr="Outils Humeur">Mood Toolkit</h1>
  <button id="lang-toggle">FR</button>
</header>

<form id="mood-form">
  <label data-en="Select your mood:" data-fr="SÃ©lectionnez votre humeur :">Select your mood:</label>
  <select id="mood-select" required>
    <option value="" disabled selected data-en="Chooseâ€¦" data-fr="Choisissezâ€¦">Chooseâ€¦</option>
    <option value="happy" data-en="Happy ðŸ˜Š" data-fr="Heureux ðŸ˜Š">Happy ðŸ˜Š</option>
    <option value="sad" data-en="Sad ðŸ˜¢" data-fr="Triste ðŸ˜¢">Sad ðŸ˜¢</option>
    <option value="angry" data-en="Angry ðŸ˜ " data-fr="FÃ¢chÃ© ðŸ˜ ">Angry ðŸ˜ </option>
    <option value="anxious" data-en="Anxious ðŸ˜Ÿ" data-fr="Anxieux ðŸ˜Ÿ">Anxious ðŸ˜Ÿ</option>
    <option value="excited" data-en="Excited ðŸ¤©" data-fr="ExcitÃ© ðŸ¤©">Excited ðŸ¤©</option>
    <option value="calm" data-en="Calm ðŸ˜Œ" data-fr="Calme ðŸ˜Œ">Calm ðŸ˜Œ</option>
    <option value="anguished" data-en="Anguished ðŸ’”" data-fr="AngoissÃ© ðŸ’”">Anguished ðŸ’”</option>
    <option value="depressed" data-en="Depressed ðŸ˜ž" data-fr="DÃ©primÃ© ðŸ˜ž">Depressed ðŸ˜ž</option>
  </select>

  <label data-en="Add notes (optional):" data-fr="Ajoutez des notes (optionnel) :">Add notes (optional):</label>
  <textarea id="notes" placeholder="..."></textarea>

  <button type="submit" id="save-btn" data-en="Save Entry" data-fr="Enregistrer">Save Entry</button>
</form>

<div id="mood-display">
  <div class="mood-avatar"></div>
  <p data-en="Select a mood to get support below." data-fr="Choisissez une humeur pour obtenir du soutien ci-dessous.">
    Select a mood to get support below.
  </p>
</div>

<section id="entries-section">
  <h2 data-en="Past Entries" data-fr="EntrÃ©es PrÃ©cÃ©dentes">Past Entries</h2>
  <ul id="entries-list"><li data-en="No entries yet." data-fr="Aucune entrÃ©e pour le moment.">No entries yet.</li></ul>
  <div style="display:flex;justify-content:space-between;flex-wrap:wrap;">
    <button id="download-pdf">Download PDF</button>
    <button id="clear-entries" data-en="Clear All" data-fr="Tout effacer">Clear All</button>
  </div>
  <button id="copy-share" data-en="Copy Mood Summary" data-fr="Copier rÃ©sumÃ©">Copy Mood Summary</button>
</section>

<div id="word-cloud"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
(function(){
  const langToggle=document.getElementById('lang-toggle'),texts=document.querySelectorAll('[data-en]');
  let lang=localStorage.lang||'en';
  const setLang=()=>{texts.forEach(el=>el.textContent=el.dataset[lang]);langToggle.textContent=lang==='en'?'FR':'EN';localStorage.lang=lang;};
  langToggle.onclick=()=>{lang=lang==='en'?'fr':'en';setLang();};
  setLang();

  const moodData = {
    happy:{
      avatar:'ðŸ˜Š',en:{coping:'Share smile or dive into a fun hobby.',reflect:'What made you happy today?',tip:'Keep the joy going!'},
      fr:{coping:'Partagez votre sourire ou plongez dans un passe-temps amusant.',reflect:'Quâ€™est-ce qui vous a rendu heureux aujourdâ€™hui?',tip:'Continuez Ã  cultiver la joie !'}
    },
    sad:{
      avatar:'ðŸ˜¢',en:{coping:'Talk with someone or write about it.',reflect:'What helped or hurt you today?',tip:'Allow yourself to feel and heal.'},
      fr:{coping:'Parlez Ã  quelquâ€™un ou Ã©crivez Ã  ce sujet.',reflect:'Quâ€™est-ce qui vous a aidÃ© ou blessÃ© aujourdâ€™hui?',tip:'Autorisez-vous Ã  ressentir et guÃ©rir.'}
    },
    angry:{
      avatar:'ðŸ˜ ',en:{coping:'Try deep breaths or a brisk walk.',reflect:'What triggered your anger?',tip:'Channel it into something positive.'},
      fr:{coping:'Essayez la respiration profonde ou une marche rapide.',reflect:'Quâ€™est-ce qui a dÃ©clenchÃ© votre colÃ¨re?',tip:'Canalisez-la en quelque chose de positif.'}
    },
    anxious:{
      avatar:'ðŸ˜Ÿ',en:{coping:'Use grounding: name 5 things you see.',reflect:'What exactly worries you?',tip:'Return to the present moment.'},
      fr:{coping:'Utilisez lâ€™ancrage : nommez 5 choses que vous voyez.',reflect:'Quâ€™est-ce qui vous inquiÃ¨te exactement?',tip:'Revenez au moment prÃ©sent.'}
    },
    excited:{
      avatar:'ðŸ¤©',en:{coping:'Channel energy: plan something creative.',reflect:'What are you excited about?',tip:'Use it to fuel productivity.'},
      fr:{coping:'Canalisez lâ€™Ã©nergie : planifiez quelque chose de crÃ©atif.',reflect:'Quâ€™est-ce qui vous enthousiasme?',tip:'Utilisez-le pour stimuler votre productivitÃ©.'}
    },
    calm:{
      avatar:'ðŸ˜Œ',en:{coping:'Enjoy nature or meditate.',reflect:'What helps you stay calm?',tip:'Savor this peace.'},
      fr:{coping:'Profitez de la nature ou mÃ©diter.',reflect:'Quâ€™est-ce qui vous aide Ã  rester calme?',tip:'Savourez cette paix.'}
    },
    anguished:{
      avatar:'ðŸ’”',en:{coping:'Reach out for helpâ€”this sounds serious.',reflect:'When did you feel this way first?',tip:'You do not have to face this alone.'},
      fr:{coping:'Demandez de lâ€™aide â€“ cela semble sÃ©rieux.',reflect:'Quand avez-vous ressenti cela pour la premiÃ¨re fois?',tip:'Vous nâ€™Ãªtes pas seul.'}
    },
    depressed:{
      avatar:'ðŸ˜ž',en:{coping:'Consider talking to a professional.',reflect:'What is one small step you can take?',tip:'Start with something gentle.'},
      fr:{coping:'Envisagez de parler Ã  un professionnel.',reflect:'Quelle est la petite Ã©tape que vous pouvez faire?',tip:'Commencez par quelque chose de doux.'}
    }
  };

  let entries=JSON.parse(localStorage.getItem('moodEntries'))||[];
  const form=document.getElementById('mood-form'),moodSelect=document.getElementById('mood-select'),
        notesInput=document.getElementById('notes'),display=document.getElementById('mood-display'),
        list=document.getElementById('entries-list'),dlPDF=document.getElementById('download-pdf'),
        clrBtn=document.getElementById('clear-entries'),copyBtn=document.getElementById('copy-share'),
        wordCloud=document.getElementById('word-cloud'),avatarEl=document.querySelector('.mood-avatar');

  const crisisCheck=mk=>['anguished','depressed'].includes(mk);

  const updateDisplay=mk=>{
    display.innerHTML='';
    if(!mk) {
      avatarEl.textContent='';
      display.appendChild(createP('select-support'));
      return;
    }
    const md=moodData[mk],t=md[lang];
    avatarEl.textContent=t?md.avatar:'';
    if(crisisCheck(mk)){
      const alert=document.createElement('div');alert.className='crisis-alert';
      alert.textContent=lang==='en'?'Urgent support suggested':'Un soutien urgent est suggÃ©rÃ©';
      display.appendChild(alert);
    }
    appendSection(mk,'coping',t.coping);
    appendFlipCard(lang==='en'?'Reflection':'RÃ©flexion', t.reflect);
    appendFlipCard(lang==='en'?'Tip':'Conseil', t.tip);
  };

  const appendSection=(mk,cls,txt)=>{
    const div=document.createElement('div');
    div.className='mood-section';
    div.textContent=(lang==='en'?encodeSection(mk,cls,txt):encodeSection(mk,cls,txt));
    display.appendChild(div);
  };
  const appendFlipCard=(front,back)=>{
    const card=document.createElement('div');card.className='flip-card';
    card.innerHTML=`<div class="flip-inner"><div class="flip-front">${front}</div><div class="flip-back">${back}</div></div>`;
    display.appendChild(card);
  };

  const encodeSection=(mk,cls,txt)=>txt;

  const renderEntries=()=>{
    list.innerHTML='';
    if(!entries.length) return list.appendChild(createLi('no-entries'));
    entries.forEach(e=>{
      const li=document.createElement('li');
      const md=moodData[e.mood];
      li.innerHTML=`<strong>${md.avatar||''} ${capitalize(e.mood)} â€“ ${new Date(e.date).toLocaleString()}</strong><p>${e.notes||(lang==='en?'No notes':'Pas de notes')}<p><em>${getReflectLabel()}: ${e.reflect||''}</em>`;
      list.appendChild(li);
    });
  };

  const createP=id=>{
    const p=document.createElement('p');
    p.textContent=document.querySelector(`[data-en="${id}"]`)?.dataset?.[lang]||'';
    return p;
  };

  const createLi=id=>{
    const li=document.createElement('li');
    li.textContent=document.querySelector(`[data-en="${id}"]`)?.dataset?.[lang]||'';
    return li;
  };

  const getReflectLabel=()=>lang==='en'?'Reflection':'RÃ©flexion';

  const capitalize=s=>s.charAt(0).toUpperCase()+s.slice(1);

  form.onsubmit=e=>{
    e.preventDefault();
    const mk=moodSelect.value,n=notesInput.value;
    if(!mk)return;
    const reflectTxt=display.querySelector('.flip-back')?.textContent;
    entries.unshift({mood:mk,notes:n,date:new Date().toISOString(),reflect:reflectTxt});
    localStorage.moodEntries=JSON.stringify(entries);
    notesInput.value='';moodSelect.value='';
    updateDisplay(mk);renderEntries();updateWordCloud();
  };

  clrBtn.onclick=()=>{
    if(confirm(lang==='en?'Clear all?':'Tout effacer ?')){
      entries=[];localStorage.moodEntries='[]';
      renderEntries();updateDisplay(null);updateWordCloud();
    }
  };

  dlPDF.onclick=()=>{
    if(!entries.length)return alert(lang==='en?'No entries to download':'Aucune entrÃ©e Ã  tÃ©lÃ©charger');
    const {jsPDF}=window.jspdf;const doc=new jsPDF();let y=20;
    doc.text(lang==='en?'Mood Journal':'Journal Humeur',105,10,{align:'center'});entries.forEach(e=>{
      if(y>270){doc.addPage();y=20}
      const md=moodData[e.mood];const t=md[lang];
      doc.text(`${md.avatar} ${capitalize(e.mood)}, ${new Date(e.date).toLocaleString()}`,10,y);y+=8;
      doc.text((lang==='en?'Notes':'Notes')+': '+(e.notes||'-'),10,y);y+=8;
      doc.text(getReflectLabel()+': '+(e.reflect||'-'),10,y);y+=12;
    });
    doc.save('mood-journal.pdf');
  };

  copyBtn.onclick=()=>{
    if(!entries.length)return alert(lang==='en?'No entries to copy':'Rien Ã  copier');
    const last=entries[0],md=moodData[last.mood];
    const summary=`${capitalize(last.mood)} â€¢ ${new Date(last.date).toLocaleDateString()}\n${last.notes||''}`;
    navigator.clipboard.writeText(summary).then(_=>alert(lang==='en?'Copied!':'CopiÃ©â€¯!'));
  };

  const updateWordCloud=()=>{
    wordCloud.innerHTML='';
    const text=entries.map(e=>e.notes).join(' ');
    const words=text.split(/\W+/).filter(w=>w.length>3);
    const freq={};words.forEach(w=>freq[w]=(freq[w]||0)+1);
    const entriesArr=Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,30);
    entriesArr.forEach(([w,c],i)=>{
      const span=document.createElement('span'),f=14+ c*4;
      span.className='word';span.textContent=w;
      span.style.fontSize=f+'px';
      span.style.left=(Math.random()*80)+'%';
      span.style.top=(Math.random()*80)+'%';
      wordCloud.appendChild(span);
    });
  };

  updateDisplay(null);renderEntries();updateWordCloud();
})();
</script>
</body>
</html>