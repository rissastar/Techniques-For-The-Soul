<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Community Mood Tracker</title>
  <meta name="description" content="Track your mood and receive supportive resources and encouragement from the community." />
  <meta name="author" content="Your Name" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    /* Background animation */
    @keyframes bgAnimation {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Reset & base */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0; padding: 0;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      background: linear-gradient(-45deg, #90caf9, #f48fb1, #a5d6a7, #ffcc80);
      background-size: 400% 400%;
      animation: bgAnimation 15s ease infinite;
      color: #1a202c;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    /* Container */
    .container {
      background: rgba(255 255 255 / 0.95);
      border-radius: 1rem;
      max-width: 720px;
      width: 100%;
      box-shadow: 0 12px 28px rgb(0 0 0 / 0.12);
      padding: 2.5rem 3rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      outline-offset: 4px;
    }

    /* Header */
    h1#main-title {
      font-size: 3rem;
      font-weight: 700;
      text-align: center;
      color: #2d3748;
      margin: 0;
      user-select: none;
      text-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    /* Mood button grid */
    .mood-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(140px,1fr));
      gap: 1.25rem;
      justify-items: center;
      align-items: stretch;
    }

    .mood-btn {
      background: white;
      border-radius: 1rem;
      padding: 1.75rem 1.5rem;
      box-shadow: 0 4px 8px rgb(0 0 0 / 0.06);
      border: 3px solid transparent;
      cursor: pointer;
      width: 100%;
      max-width: 180px;
      font-weight: 600;
      color: #2d3748;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition:
        transform 0.3s ease,
        box-shadow 0.3s ease,
        border-color 0.3s ease;
      user-select: none;
    }
    .mood-btn:hover,
    .mood-btn:focus-visible {
      outline: none;
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgb(0 0 0 / 0.15);
      border-color: var(--mood-color);
      color: var(--mood-color);
      font-weight: 700;
      z-index: 1;
    }

    .mood-btn .emoji {
      font-size: 3.5rem;
      margin-bottom: 0.6rem;
      line-height: 1;
    }

    /* Dynamic mood colors using CSS variables */
    /* These get set inline via JS for each mood button */
    .mood-btn[data-mood="overwhelmed"] { --mood-color: #fda085; }
    .mood-btn[data-mood="struggling"] { --mood-color: #e53e3e; }
    .mood-btn[data-mood="managing"] { --mood-color: #d69e2e; }
    .mood-btn[data-mood="neutral"] { --mood-color: #718096; }
    .mood-btn[data-mood="good"] { --mood-color: #38a169; }
    .mood-btn[data-mood="thriving"] { --mood-color: #3182ce; }

    /* Thank you section */
    #thank-you-section {
      display: none;
      text-align: center;
    }
    #thank-you-section[aria-hidden="false"] {
      display: block;
    }

    #thank-you-section h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 0 0 0.3rem 0;
      color: var(--mood-color);
    }

    #thank-you-section p {
      font-size: 1.125rem;
      margin: 0.3rem 0;
      color: #4a5568;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Recommended resources */
    .recommended-links {
      margin-top: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .recommended-links a {
      color: var(--mood-color);
      font-weight: 600;
      text-decoration: underline;
      font-size: 1rem;
      transition: color 0.25s ease;
    }
    .recommended-links a:hover,
    .recommended-links a:focus-visible {
      color: #2c5282;
      outline-offset: 3px;
    }

    /* Affirmation & tip */
    .affirmation, .tip {
      font-style: italic;
      color: #4a5568;
      margin-top: 0.5rem;
    }

    /* Check in again button */
    #checkin-again-btn {
      margin-top: 2rem;
      background-color: var(--mood-color);
      border: none;
      color: white;
      font-size: 1.125rem;
      font-weight: 700;
      padding: 1rem 2rem;
      border-radius: 1rem;
      cursor: pointer;
      box-shadow: 0 6px 14px rgb(0 0 0 / 0.15);
      transition: background-color 0.3s ease;
      user-select: none;
    }
    #checkin-again-btn:hover,
    #checkin-again-btn:focus-visible {
      background-color: #2c5282;
      outline: none;
    }

    /* Anonymous messages container */
    .anonymous-messages {
      margin-top: 2.5rem;
      background: #edf2f7;
      padding: 1.25rem 1.5rem;
      border-radius: 1rem;
      max-height: 180px;
      overflow-y: auto;
      font-weight: 600;
      color: #2d3748;
      box-shadow: inset 0 0 6px rgb(0 0 0 / 0.08);
      user-select: none;
    }
    .anonymous-messages h4 {
      margin: 0 0 1rem 0;
      font-weight: 700;
      color: var(--mood-color);
      text-align: center;
    }
    .anonymous-messages ul {
      list-style-type: none;
      margin: 0; padding: 0;
    }
    .anonymous-messages ul li {
      margin-bottom: 0.65rem;
      font-style: italic;
      font-size: 1rem;
      line-height: 1.3;
    }

    /* Toast */
    #toast {
      position: fixed;
      bottom: 1.5rem;
      left: 50%;
      transform: translateX(-50%);
      background: #48bb78;
      color: white;
      font-weight: 700;
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 6px 16px rgb(0 0 0 / 0.2);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 9999;
      max-width: 90vw;
      text-align: center;
    }
    #toast.show {
      opacity: 1;
      pointer-events: auto;
    }

    /* Responsive */
    @media (max-width: 480px) {
      h1#main-title {
        font-size: 2.25rem;
      }
      .mood-btn {
        max-width: none;
      }
      #thank-you-section h2 {
        font-size: 2rem;
      }
      #checkin-again-btn {
        width: 100%;
        padding: 1rem 0;
      }
    }
  </style>
</head>
<body>
  <main class="container" role="main" aria-live="polite">
    <h1 id="main-title">Community Mood Tracker</h1>

    <section id="mood-grid" class="mood-grid" role="list" aria-label="Select your current mood"></section>

    <section id="thank-you-section" aria-hidden="true" tabindex="-1" aria-label="Your mood check-in summary">
      <h2 id="mood-label"></h2>
      <p id="mood-support-text"></p>
      <p class="tip" id="mood-tip"></p>
      <p class="affirmation" id="mood-affirmation"></p>

      <nav class="recommended-links" aria-label="Recommended resources"></nav>

      <button id="checkin-again-btn" aria-label="Check in again">Check In Again</button>

      <div class="anonymous-messages" aria-label="Anonymous community support messages">
        <h4>Community Support Messages</h4>
        <ul id="anonymous-messages-list" role="list"></ul>
      </div>
    </section>
  </main>

  <div id="toast" role="alert" aria-live="assertive" aria-atomic="true"></div>

  <script>
    const moods = [
      {
        id: 'overwhelmed',
        emoji: 'ðŸ˜µâ€ðŸ’«',
        label: 'Overwhelmed',
        bg: 'linear-gradient(135deg, #f6d365 0%, #fda085 100%)',
        supportPrompt: 'Itâ€™s okay to feel this way â€” pause and breathe.',
        tip: 'Try progressive muscle relaxation.',
        affirmation: 'I give myself permission to pause.',
        resources: [
          { text: 'Grounding Worksheet (PDF)', url: 'https://oklahomatfcbt.org/wp-content/uploads/2018/08/Grounding-Worksheet.pdf' },
          { text: 'TFâ€‘CBT Teen Workbook (PDF)', url: 'https://tfcbt.org/wp-content/uploads/2019/02/Revised-Dealing-with-Trauma-TF-CBTWorkbook-for-Teens-.pdf' }
        ]
      },
      {
        id: 'struggling',
        emoji: 'ðŸ”´',
        label: 'Struggling',
        bg: 'linear-gradient(135deg, #f44336 0%, #e57373 100%)',
        supportPrompt: 'Your courage matters.',
        tip: 'Try the 5â€‘4â€‘3â€‘2â€‘1 grounding technique.',
        affirmation: 'I am safe in this moment.',
        resources: [
          { text: 'Grounding Worksheet (PDF)', url: 'https://oklahomatfcbt.org/wp-content/uploads/2018/08/Grounding-Worksheet.pdf' },
          { text: 'Anxiety & Depression Workbook (PDF)', url: 'https://health.uark.edu/mental-health/resources/caps-resources-anxiety-depression-reduction-workbook.pdf' }
        ]
      },
      {
        id: 'managing',
        emoji: 'ðŸŸ¡',
        label: 'Managing',
        bg: 'linear-gradient(135deg, #fff176 0%, #ffeb3b 100%)',
        supportPrompt: 'Youâ€™re doing the best you can.',
        tip: 'Practice square breathing: inhale/exhale for 4 counts.',
        affirmation: 'I am doing well enough.',
        resources: [
          { text: 'Grounding Worksheet (PDF)', url: 'https://oklahomatfcbt.org/wp-content/uploads/2018/08/Grounding-Worksheet.pdf' },
          { text: 'Anxiety & Depression Workbook (PDF)', url: 'https://health.uark.edu/mental-health/resources/caps-resources-anxiety-depression-reduction-workbook.pdf' }
        ]
      },
      {
        id: 'neutral',
        emoji: 'âšªï¸',
        label: 'Neutral',
        bg: 'linear-gradient(135deg, #cfd8dc 0%, #eceff1 100%)',
        supportPrompt: 'Staying steady can be powerful.',
        tip: 'Try a guided mindfulness for 5 mins.',
        affirmation: 'I am centered.',
        resources: [
          { text: 'Grounding Worksheet (PDF)', url: 'https://oklahomatfcbt.org/wp-content/uploads/2018/08/Grounding-Worksheet.pdf' }
        ]
      },
      {
        id: 'good',
        emoji: 'ðŸŸ¢',
        label: 'Doing Well',
        bg: 'linear-gradient(135deg, #81c784 0%, #66bb6a 100%)',
        supportPrompt: 'Youâ€™re bringing light â€” thank you!',
        tip: 'Spend time reflecting on what feels good.',
        affirmation: 'I choose to notice joy.',
        resources: [
          { text: 'Anxiety & Depression Workbook (PDF)', url: 'https://health.uark.edu/mental-health/resources/caps-resources-anxiety-depression-reduction-workbook.pdf' }
        ]
      },
      {
        id: 'thriving',
        emoji: 'ðŸ”µ',
        label: 'Thriving',
        bg: 'linear-gradient(135deg, #64b5f6 0%, #42a5f5 100%)',
        supportPrompt: 'Your energy inspires â€” shine on!',
        tip: 'Set a small goal and celebrate it.',
        affirmation: 'I am thriving.',
        resources: [
          { text: 'TFâ€‘CBT Teen Workbook (PDF)', url: 'https://tfcbt.org/wp-content/uploads/2019/02/Revised-Dealing-with-Trauma-TF-CBTWorkbook-for-Teens-.pdf' }
        ]
      }
    ];

    const anonymousMessages = [
      "You're doing great â€” keep going!",
      "Every day is a new chance to heal.",
      "You are not alone in this.",
      "Small steps are still progress.",
      "You matter more than you know.",
      "Take a deep breath â€” you've got this.",
      "Your feelings are valid and important.",
      "Strength grows in moments of challenge.",
      "Hope is alive within you.",
      "You are stronger than your struggles."
    ];

    const MKEY = 'communityMood';

    // Elements
    const moodGrid = document.getElementById('mood-grid');
    const thankYou = document.getElementById('thank-you-section');
    const moodLabel = document.getElementById('mood-label');
    const moodSupport = document.getElementById('mood-support-text');
    const moodTip = document.getElementById('mood-tip');
    const moodAff = document.getElementById('mood-affirmation');
    const recLinks = document.querySelector('.recommended-links');
    const messagesList = document.getElementById('anonymous-messages-list');
    const checkinAgain = document.getElementById('checkin-again-btn');
    const toast = document.getElementById('toast');

    // Render mood buttons
    function renderButtons() {
      moods.forEach(m => {
        const btn = document.createElement('button');
        btn.className = 'mood-btn';
        btn.setAttribute('role', 'listitem');
        btn.setAttribute('aria-label', m.label + ' mood');
        btn.setAttribute('data-mood', m.id);
        btn.style.setProperty('--mood-color', getMoodColor(m.id));
        btn.innerHTML = `<span class="emoji" aria-hidden="true">${m.emoji}</span><span>${m.label}</span>`;
        btn.addEventListener('click', () => selectMood(m));
        moodGrid.appendChild(btn);
      });
    }

    // Map mood id to color for CSS variable fallback
    function getMoodColor(id) {
      switch(id) {
        case 'overwhelmed': return '#fda085';
        case 'struggling': return '#e53e3e';
        case 'managing': return '#d69e2e';
        case 'neutral': return '#718096';
        case 'good': return '#38a169';
        case 'thriving': return '#3182ce';
        default: return '#4c51bf';
      }
    }

    // Select mood and show thank you section
    function selectMood(m) {
      localStorage.setItem(MKEY, m.id);
      document.body.style.background = m.bg;

      moodGrid.setAttribute('aria-hidden', 'true');
      moodGrid.style.display = 'none';

      thankYou.setAttribute('aria-hidden', 'false');
      thankYou.style.display = 'block';

      moodLabel.textContent = `${m.emoji} ${m.label}`;
      moodSupport.textContent = m.supportPrompt;
      moodTip.textContent = 'Tip: ' + m.tip;
      moodAff.textContent = 'Affirmation: "' + m.affirmation + '"';

      recLinks.innerHTML = '';
      m.resources.forEach(link => {
        const a = document.createElement('a');
        a.href = link.url;
        a.target = '_blank';
        a.rel = 'noopener noreferrer nofollow';
        a.textContent = link.text;
        recLinks.appendChild(a);
      });

      displayAnonymousMessages();
      showToast('Thanks for checking in!');
      thankYou.focus();
    }

    // Show 5 random anonymous messages
    function displayAnonymousMessages() {
      messagesList.innerHTML = '';
      const shuffled = anonymousMessages
        .map(value => ({ value, sort: Math.random() }))
        .sort((a, b) => a.sort - b.sort)
        .map(({ value }) => value)
        .slice(0, 5);
      shuffled.forEach(msg => {
        const li = document.createElement('li');
        li.textContent = msg;
        messagesList.appendChild(li);
      });
    }

    // Show toast notification
    function showToast(message) {
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3500);
    }

    // Reset for check in again
    checkinAgain.addEventListener('click', () => {
      localStorage.removeItem(MKEY);
      thankYou.setAttribute('aria-hidden', 'true');
      thankYou.style.display = 'none';
      moodGrid.setAttribute('aria-hidden', 'false');
      moodGrid.style.display = 'grid';
      document.body.style.background = 'linear-gradient(-45deg, #90caf9, #f48fb1, #a5d6a7, #ffcc80)';
      toast.textContent = '';
      moodGrid.querySelector('button').focus();
    });

    // Initialize app
    function init() {
      renderButtons();
      const saved = localStorage.getItem(MKEY);
      if (saved) {
        const m = moods.find(x => x.id === saved);
        if (m) {
          selectMood(m);
          return;
        }
      }
      // Default: show mood grid
      moodGrid.setAttribute('aria-hidden', 'false');
      moodGrid.style.display = 'grid';
      thankYou.setAttribute('aria-hidden', 'true');
      thankYou.style.display = 'none';
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>