<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Recovery Toolkit</title>
  <style>
    :root {
      --primary: #3498db;
      --accent: #2ecc71;
      --danger: #e74c3c;
      --warning: #f39c12;
      --dark: #2c3e50;
      --light: #ecf0f1;
      --font-main: 'Segoe UI', sans-serif;
    }

    body {
      font-family: var(--font-main);
      margin: 0;
      background: linear-gradient(to bottom right, #f0f9ff, #c2f0ff);
      color: #333;
      overflow-x: hidden;
    }

    header {
      background: url('https://images.unsplash.com/photo-1506748686214-e9df14d4d9d0?fit=crop&w=1350&q=80') center/cover no-repeat;
      color: white;
      padding: 50px 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
      text-shadow: 1px 1px 5px #000;
    }

    nav {
      display: flex;
      justify-content: space-around;
      background: var(--dark);
      color: white;
      padding: 10px 0;
      font-size: 0.9rem;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .nav-tab {
      flex: 1;
      text-align: center;
      padding: 10px 0;
      cursor: pointer;
      transition: background 0.3s;
    }

    .nav-tab:hover, .nav-tab.active {
      background: var(--primary);
    }

    .tab-content {
      display: none;
      padding: 20px;
    }

    .tab-content.active {
      display: block;
    }

    .card {
      background: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    .form-input, textarea, input[type="text"], input[type="tel"] {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    .btn {
      display: inline-block;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }

    .btn-success { background: var(--accent); }
    .btn-primary { background: var(--primary); }
    .btn-danger { background: var(--danger); }
    .btn-warning { background: var(--warning); }

    .resource-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .resource-card {
      padding: 10px;
      background: var(--light);
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .resource-card h4 {
      margin-top: 0;
    }

    @media (max-width: 600px) {
      .resource-grid {
        grid-template-columns: 1fr;
      }

      nav {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header>
    Addiction & Recovery Toolkit
  </header>
  <nav>
    <div class="nav-tab active" onclick="showTab('tracker')">Tracker</div>
    <div class="nav-tab" onclick="showTab('goals')">Goals</div>
    <div class="nav-tab" onclick="showTab('wellness')">Wellness</div>
    <div class="nav-tab" onclick="showTab('achievements')">Milestones</div>
    <div class="nav-tab" onclick="showTab('minipages')">Mini Pages</div>
  </nav>
  <div class="container">
  
      <!-- Tracker Tab -->
    <div id="tracker" class="tab-content active">
      <div class="card">
        <h3>Sobriety Tracker</h3>
        <p>You‚Äôve been sober for <strong><span id="sobrietyCounter">0</span> days</strong>.</p>
        <div style="margin-bottom: 10px;">
          <button class="btn btn-primary" onclick="updateSobrietyDate()">Set Start Date</button>
          <button class="btn btn-warning" onclick="resetCounter()">Reset</button>
        </div>
        <div>
          <label>30 Day Goal</label>
          <div style="background: #eee; border-radius: 10px;">
            <div id="goal30" style="height: 10px; background: var(--primary); width: 0%; border-radius: 10px;"></div>
          </div>
          <label>90 Day Goal</label>
          <div style="background: #eee; border-radius: 10px;">
            <div id="goal90" style="height: 10px; background: var(--accent); width: 0%; border-radius: 10px;"></div>
          </div>
          <label>1 Year Goal</label>
          <div style="background: #eee; border-radius: 10px;">
            <div id="goal365" style="height: 10px; background: var(--danger); width: 0%; border-radius: 10px;"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>How Are You Feeling?</h3>
        <div style="display: flex; justify-content: space-around;">
          <button class="btn mood-btn" data-mood="üòä" onclick="setMood('üòä')">üòä</button>
          <button class="btn mood-btn" data-mood="üòê" onclick="setMood('üòê')">üòê</button>
          <button class="btn mood-btn" data-mood="üò¢" onclick="setMood('üò¢')">üò¢</button>
          <button class="btn mood-btn" data-mood="üò†" onclick="setMood('üò†')">üò†</button>
        </div>
        <div style="margin-top: 10px;">
          <label class="form-label">Reflection</label>
          <textarea rows="3" class="form-input" placeholder="What‚Äôs going on today? How are you coping?"></textarea>
        </div>
        <button class="btn btn-success" onclick="saveProgress()">Save Mood Check</button>
      </div>

      <div class="card">
        <h3>üåü Daily Motivation</h3>
        <p id="dailyQuote" style="font-style: italic;"></p>
        <button class="btn btn-primary" onclick="generateQuote()">New Quote</button>
      </div>
    </div>

    <!-- Goals Tab -->
    <div id="goals" class="tab-content">
      <div class="card">
        <h3>Recovery Goals</h3>
        <p>Set SMART (Specific, Measurable, Achievable, Relevant, Time-bound) goals in key areas of your healing journey.</p>

        <div class="form-group">
          <label class="form-label">Mental Health Goal</label>
          <input type="text" class="form-input" placeholder="e.g. Attend therapy weekly, manage anxiety...">
        </div>
        <div class="form-group">
          <label class="form-label">Emotional Goal</label>
          <input type="text" class="form-input" placeholder="e.g. Journal daily, express my feelings more...">
        </div>
        <div class="form-group">
          <label class="form-label">Physical Goal</label>
          <input type="text" class="form-input" placeholder="e.g. Exercise 3x/week, sleep 8hrs/night...">
        </div>
        <div class="form-group">
          <label class="form-label">Social Goal</label>
          <input type="text" class="form-input" placeholder="e.g. Join a support group, reconnect with family...">
        </div>
        <div class="form-group">
          <label class="form-label">Addiction Recovery Goal</label>
          <input type="text" class="form-input" placeholder="e.g. Stay sober for 30 days, attend NA/AA...">
        </div>
        <button class="btn btn-success">Save My Goals</button>
      </div>

      <div class="card">
        <h3>‚ú® Goal Suggestions</h3>
        <ul>
          <li>Build a daily gratitude habit</li>
          <li>Stick to a bedtime routine</li>
          <li>Reach out for support weekly</li>
          <li>Practice mindfulness daily</li>
          <li>Forgive myself for the past</li>
        </ul>
      </div>
    </div>

    <!-- Crisis Planning Tab -->
    <div id="crisis" class="tab-content">
      <div class="card">
        <h3>Crisis Planning</h3>
        <div class="form-group">
          <label class="form-label">Emergency Contact Name</label>
          <input type="text" class="form-input" placeholder="Name of trusted person">
        </div>
        <div class="form-group">
          <label class="form-label">Emergency Contact Phone</label>
          <input type="tel" class="form-input" placeholder="Phone number">
        </div>
        <div class="form-group">
          <label class="form-label">Triggers to Avoid</label>
          <textarea class="form-input" rows="3" placeholder="Places, people, emotions to avoid..."></textarea>
        </div>
        <button class="btn btn-success">Save Crisis Plan</button>
      </div>
    </div>
    
    <!-- Wellness Tab -->
<div id="wellness" class="tab-content">
  <div class="card">
    <h3>Daily Wellness Check</h3>
    <div class="form-group">
      <label class="form-label">Sleep Quality (1-10)</label>
      <input type="range" min="1" max="10" value="7" class="form-input" style="height: 30px;">
    </div>
    <div class="form-group">
      <label class="form-label">Energy Level (1-10)</label>
      <input type="range" min="1" max="10" value="7" class="form-input" style="height: 30px;">
    </div>
    <div class="form-group">
      <label class="form-label">Stress Level (1-10)</label>
      <input type="range" min="1" max="10" value="5" class="form-input" style="height: 30px;">
    </div>
    <button class="btn btn-success">Log Wellness Data</button>
  </div>

  <div class="card">
    <h3>Coping Strategies</h3>
    <div class="resource-grid">
      <div class="resource-card">
        <h4>üßò‚Äç‚ôÄÔ∏è Mindfulness</h4>
        <p>Practice deep breathing or grounding.</p>
        <ul>
          <li>5-4-3-2-1 Senses</li>
          <li>Box Breathing</li>
        </ul>
        <button class="btn btn-primary">Try Meditation</button>
      </div>
      <div class="resource-card">
        <h4>üèÉ‚Äç‚ôÇÔ∏è Physical Movement</h4>
        <p>Move your body to shift energy.</p>
        <ul>
          <li>Walk or jog</li>
          <li>Stretch or do yoga</li>
        </ul>
        <button class="btn btn-primary">Watch Exercise</button>
      </div>
      <div class="resource-card">
        <h4>üé® Creative Expression</h4>
        <p>Express emotions through art or music.</p>
        <ul>
          <li>Write a poem</li>
          <li>Paint or sketch your feelings</li>
        </ul>
        <button class="btn btn-primary">Art Ideas</button>
      </div>
      <div class="resource-card">
        <h4>üìû Connection</h4>
        <p>Reach out and speak up.</p>
        <ul>
          <li>Call a friend or sponsor</li>
          <li>Join an online support group</li>
        </ul>
        <button class="btn btn-primary">Call Now</button>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>üÜò Crisis Management Tools</h3>
    <div class="resource-grid">
      <div class="resource-card">
        <h4>üö® Panic Attack Help</h4>
        <p>Use grounding and reminders.</p>
        <button class="btn btn-danger" onclick="panicAttackHelper()">Help Me</button>
      </div>
      <div class="resource-card">
        <h4>‚ö° Craving Help</h4>
        <p>Pause and play the tape forward.</p>
        <button class="btn btn-warning" onclick="cravingHelper()">Manage Craving</button>
      </div>
      <div class="resource-card">
        <h4>üßò Breathing</h4>
        <p>Use deep breaths to recenter.</p>
        <button class="btn btn-primary" onclick="startBreathingExercise()">Breathe</button>
      </div>
      <div class="resource-card">
        <h4>üôè Gratitude Journal</h4>
        <p>Write 3 things you‚Äôre thankful for.</p>
        <button class="btn btn-success" onclick="openGratitudeJournal()">Open Journal</button>
      </div>
    </div>
  </div>
</div>

<!-- Achievements Tab -->
<div id="achievements" class="tab-content">
  <div class="card">
    <h3>Recovery Milestones</h3>
    <div class="achievements">
      <div class="achievement locked" id="day1">
        <h4>üåÖ First Day</h4>
        <p>You started. That‚Äôs huge.</p>
      </div>
      <div class="achievement locked" id="week1">
        <h4>üìÖ 1 Week</h4>
        <p>7 days strong!</p>
      </div>
      <div class="achievement locked" id="month1">
        <h4>üóìÔ∏è 1 Month</h4>
        <p>30 days sober</p>
      </div>
      <div class="achievement locked" id="month3">
        <h4>üå∏ 3 Months</h4>
        <p>90 days and thriving</p>
      </div>
      <div class="achievement locked" id="month6">
        <h4>üåª 6 Months</h4>
        <p>Half a year!</p>
      </div>
      <div class="achievement locked" id="year1">
        <h4>üéâ 1 Year</h4>
        <p>You did it ‚Äî one whole year!</p>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>Add Personal Wins</h3>
    <div class="form-group">
      <label class="form-label">Achievement</label>
      <input type="text" class="form-input" placeholder="e.g. Attended a support meeting">
    </div>
    <button class="btn btn-success">Save Achievement</button>
  </div>
</div>

<!-- Mini Pages (your original content) -->
<div id="mini-pages" class="tab-content">
  <div class="card">
    <h3>üìö Crisis Toolkit</h3>
    <iframe src="https://rissastar.github.io/Techniques-For-The-Soul/crisis-toolkit.html" style="width: 100%; height: 400px; border: none; border-radius: 10px;"></iframe>
  </div>

  <div class="card">
    <h3>üìù Stories & Reflections</h3>
    <iframe src="https://rissastar.github.io/Techniques-For-The-Soul/stories.html" style="width: 100%; height: 400px; border: none; border-radius: 10px;"></iframe>
  </div>
</div>

<script>
// Variables
let sobrietyStartDate = null;
let currentMood = null;

// Motivational quotes
const quotes = [
  "Recovery is not a race. You don't have to feel guilty if it takes you longer than you thought it would.",
  "The only person you are destined to become is the person you decide to be.",
  "Every day is a new beginning. Take a deep breath, smile, and start again.",
  "You are stronger than your addiction. You are worth more than your worst day.",
  "Progress, not perfection. Every step forward counts.",
  "Recovery is about being grateful for the chance to live life fully.",
  "One day at a time. One moment at a time. You've got this.",
  "Your current situation is not your final destination.",
  "The comeback is always stronger than the setback.",
  "You didn't come this far to only come this far."
];

// Show tab content and activate tab button
function showTab(tabName, evt) {
  const contents = document.querySelectorAll('.tab-content');
  contents.forEach(c => c.classList.remove('active'));

  const tabs = document.querySelectorAll('.nav-tab');
  tabs.forEach(t => t.classList.remove('active'));

  document.getElementById(tabName).classList.add('active');
  if (evt) evt.currentTarget.classList.add('active');
}

// Update sobriety date prompt & calculations
function updateSobrietyDate() {
  const date = prompt("Enter your recovery start date (YYYY-MM-DD):");
  if (date && !isNaN(Date.parse(date))) {
    sobrietyStartDate = new Date(date);
    saveData();
    updateCounter();
    updateProgressBars();
    checkAchievements();
  } else {
    alert('Please enter a valid date in format YYYY-MM-DD');
  }
}

// Update sobriety days counter UI
function updateCounter() {
  if (!sobrietyStartDate) return;
  const today = new Date();
  const diff = today.getTime() - sobrietyStartDate.getTime();
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  document.getElementById('sobrietyCounter').textContent = days;
}

// Reset counter to today
function resetCounter() {
  if (confirm('Are you sure you want to reset your recovery date to today?')) {
    sobrietyStartDate = new Date();
    saveData();
    updateCounter();
    updateProgressBars();
    checkAchievements();
  }
}

// Update progress bars for goals
function updateProgressBars() {
  if (!sobrietyStartDate) return;
  const today = new Date();
  const diff = today.getTime() - sobrietyStartDate.getTime();
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));

  const bars = [
    { id: 'goal30', daysGoal: 30 },
    { id: 'goal90', daysGoal: 90 },
    { id: 'goal365', daysGoal: 365 }
  ];

  bars.forEach(bar => {
    const progress = Math.min((days / bar.daysGoal) * 100, 100);
    const el = document.getElementById(bar.id);
    if (el) el.style.width = progress + '%';
  });
}

// Unlock achievements based on sobriety days
function checkAchievements() {
  if (!sobrietyStartDate) return;
  const today = new Date();
  const diff = today.getTime() - sobrietyStartDate.getTime();
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));

  const milestones = [
    { id: 'day1', minDays: 1 },
    { id: 'week1', minDays: 7 },
    { id: 'month1', minDays: 30 },
    { id: 'month3', minDays: 90 },
    { id: 'month6', minDays: 180 },
    { id: 'year1', minDays: 365 }
  ];

  milestones.forEach(m => {
    if (days >= m.minDays) unlockAchievement(m.id);
  });
}

function unlockAchievement(id) {
  const el = document.getElementById(id);
  if (el && el.classList.contains('locked')) {
    el.classList.remove('locked');
    el.classList.add('unlocked');
    showAchievementNotification(el.querySelector('h4').textContent);
  }
}

// Show achievement notification
function showAchievementNotification(title) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    z-index: 10000;
    animation: slideIn 0.5s ease-out;
  `;
  notification.innerHTML = `
    <h4 style="margin:0 0 5px 0;">üéâ Achievement Unlocked!</h4>
    <p style="margin:0;">${title}</p>
  `;
  document.body.appendChild(notification);
  setTimeout(() => {
    notification.style.animation = 'slideOut 0.5s ease-in';
    setTimeout(() => notification.remove(), 500);
  }, 3000);
}

// Mood selection and save
function setMood(mood) {
  currentMood = mood;
  document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
  const selectedBtn = document.querySelector(`.mood-btn[data-mood="${mood}"]`);
  if (selectedBtn) selectedBtn.classList.add('selected');
}

function saveProgress() {
  const reflection = document.querySelector('#tracker textarea').value.trim();
  if (!currentMood || !reflection) {
    alert('Please select your mood and write a reflection before saving.');
    return;
  }
  alert('Progress saved! Keep up the great work!');
  // Clear form after save
  document.querySelector('#tracker textarea').value = '';
  document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
  currentMood = null;
}

// Generate and display motivational quote
function generateQuote() {
  const q = quotes[Math.floor(Math.random() * quotes.length)];
  document.getElementById('dailyQuote').textContent = `"${q}"`;
}

// Breathing exercise modal & cycle
function startBreathingExercise() {
  const modal = createModal(`
    <h3>üßò‚Äç‚ôÄÔ∏è Breathing Exercise</h3>
    <div id="breathingCircle" style="
      width: 150px; height: 150px; border-radius: 50%; background: linear-gradient(135deg, #3498db, #2980b9);
      margin: 20px auto; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;
      font-weight: bold; transition: transform 4s ease-in-out;
    ">Breathe</div>
    <p id="breathingText">Follow the circle to breathe deeply</p>
    <button id="closeBreathing" class="btn btn-danger" style="margin-top:20px;">Close</button>
  `);

  let phase = 'inhale';
  const circle = modal.querySelector('#breathingCircle');
  const text = modal.querySelector('#breathingText');
  const closeBtn = modal.querySelector('#closeBreathing');

  closeBtn.onclick = () => {
    document.body.removeChild(modal);
  };

  function breathingCycle() {
    if (!document.body.contains(modal)) return; // stop if closed
    if (phase === 'inhale') {
      circle.style.transform = 'scale(1.3)';
      text.textContent = 'Breathe in... (4 seconds)';
      phase = 'hold1';
      setTimeout(breathingCycle, 4000);
    } else if (phase === 'hold1') {
      text.textContent = 'Hold... (4 seconds)';
      phase = 'exhale';
      setTimeout(breathingCycle, 4000);
    } else if (phase === 'exhale') {
      circle.style.transform = 'scale(1)';
      text.textContent = 'Breathe out... (4 seconds)';
      phase = 'hold2';
      setTimeout(breathingCycle, 4000);
    } else {
      text.textContent = 'Hold... (4 seconds)';
      phase = 'inhale';
      setTimeout(breathingCycle, 4000);
    }
  }
  setTimeout(breathingCycle, 100);
}

// Utility: create modal overlay with content
function createModal(innerHTML) {
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;
    z-index: 10000; padding: 1rem;
  `;
  const content = document.createElement('div');
  content.style.cssText = `
    background: white; padding: 1.5rem; border-radius: 12px; max-width: 320px; width: 100%;
    box-shadow: 0 8px 24px rgba(0,0,0,0.3); text-align: center;
  `;
  content.innerHTML = innerHTML;
  modal.appendChild(content);
  document.body.appendChild(modal);
  return content;
}

// Saving and loading to localStorage
function saveData() {
  const data = {
    sobrietyStartDate: sobrietyStartDate ? sobrietyStartDate.toISOString() : null,
  };
  localStorage.setItem('addictionToolkitData', JSON.stringify(data));
}

function loadData() {
  const saved = localStorage.getItem('addictionToolkitData');
  if (!saved) return;
  try {
    const data = JSON.parse(saved);
    sobrietyStartDate = data.sobrietyStartDate ? new Date(data.sobrietyStartDate) : null;
  } catch {
    sobrietyStartDate = null;
  }
}

// Initialization
window.onload = () => {
  loadData();
  showTab('crisis');
  updateCounter();
  updateProgressBars();
  checkAchievements();
  generateQuote();
};
</script>
</html>