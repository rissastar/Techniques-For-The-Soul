<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grief Support Toolkit</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;500;700&display=swap"
    rel="stylesheet"
  />
  <style>
    /* â”â”â”â”â”â”â”â”â” Theme Variables â”â”â”â”â”â”â”â”â” */
    :root {
      --bg-img: url('https://images.pexels.com/photos/5886048/pexels-photo-5886048.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260');
      --bg-dark: #18191a;
      --text-light: #f5f5f5;
      --text-dark: #333;
      --card-bg: rgba(255,255,255,0.95);
      --shadow: rgba(0,0,0,0.1);
      --accent: #5A3E99;
      --primary: #7f5af0;
      --primary-light: #a865f9;
    }

    body {
      margin: 0; padding: 0;
      font-family: 'Quicksand', sans-serif;
      background: var(--bg-img) center/cover no-repeat fixed;
      color: var(--text-dark);
      min-height: 100vh;
      transition: background 0.5s, color 0.5s;
    }

    body.theme-dark {
      background: var(--bg-dark);
      color: var(--text-light);
    }

    h1,h2 {
      margin-bottom: 0.6rem;
      color: var(--accent);
      font-weight: 500;
    }

    a {
      color: var(--accent);
      text-decoration: none;
      transition: opacity 0.2s;
    }

    a:hover {
      opacity: 0.8;
    }

    button, select, textarea, input {
      font-family: inherit;
      outline: none;
    }

    /* â”â”â”â”â”â”â”â”â” Layout & Components â”â”â”â”â”â”â”â”â” */

    .theme-picker {
      position: fixed; top: 1rem; left: 1rem; z-index: 1000;
      background: rgba(255,255,255,0.8); padding:0.3rem 0.5rem;
      border-radius: 8px;
    }

    #sosBtn {
      position: fixed; bottom: 1rem; left: 1rem;
      background: #e73c7e; color: white; width: 50px; height: 50px;
      border: none; border-radius: 50%; font-size: 1.4rem;
      cursor: pointer; box-shadow: 0 4px 12px var(--shadow);
      transition: transform 0.2s;
      z-index: 1000;
    }
    #sosBtn:hover {
      transform: scale(1.1);
    }

    .container {
      max-width: 1000px;
      margin: 2rem auto 4rem;
      padding: 1rem 2rem;
      backdrop-filter: blur(10px);
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 8px 24px var(--shadow);
    }

    .grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }

    .card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px var(--shadow);
    }

    .card h2 {
      margin: 0;
    }

    .card button, .card textarea, .card input, .card select {
      margin-top: 0.5rem;
    }

    button, select {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 0.6rem 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover, select:hover {
      background: var(--primary-light);
    }

    textarea, input {
      width: 100%;
      padding: 0.7rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    /* â”â”â”â”â”â”â”â”â” Body Map â”â”â”â”â”â”â”â”â” */

    .body-map {
      position: relative;
      background: url('https://upload.wikimedia.org/wikipedia/commons/1/17/Human_body_outline.png')
        center/contain no-repeat;
      width: 100%;
      height: 320px;
      border-radius: 10px;
      background-color: #f4f4f4;
    }

    .body-spot {
      position: absolute;
      width: 20px; height: 20px;
      background: rgba(255,87,34,0.8);
      border: 2px solid white;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .body-spot:hover {
      transform: scale(1.2);
    }

    /* Carousel */
    .carousel { overflow: hidden; }
    .carousel-track {
      display: flex;
      transition: transform 0.4s ease;
    }
    .carousel-item {
      min-width: 260px;
      background: var(--card-bg);
      border-radius: 8px;
      padding: 1rem;
      margin-right: 1rem;
      box-shadow: 0 4px 12px var(--shadow);
    }
    .carousel-controls {
      text-align: center;
      margin-top: 0.5rem;
    }
    .carousel-controls button {
      margin: 0 0.3rem;
      font-size: 1.2rem;
      background: var(--primary);
      border: none;
      color: white;
      border-radius: 50%;
      width: 30px; height: 30px;
      cursor: pointer;
    }

    /* Modals */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      display: none;
      z-index: 1000;
    }
    .modal {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 20px 40px var(--shadow);
      width: 90%;
      max-width: 400px;
      display: none;
      z-index: 1001;
    }
    .modal h3 { margin-top: 0; }
    .modal p { line-height: 1.4; margin-bottom: 1rem; }
    .close-btn {
      background: #e73c7e;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
    }

    /* Mood Tracker */
    .mood-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 0.5rem;
    }
    .mood-buttons button {
      flex-grow: 1;
      font-size: 1.6rem;
      margin: 0 0.3rem;
      background: #eee;
      border-radius: 8px;
      padding: 0.5rem;
      transition: transform 0.2s, background 0.3s;
    }
    .mood-buttons button[aria-checked="true"] {
      background: var(--primary);
      color: white;
      transform: scale(1.1);
    }
    .progress-bar {
      background: #ddd;
      width: 100%;
      height: 10px;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 0.5rem;
    }
    .progress-fill {
      background: var(--primary-light);
      height: 100%;
      width: 0;
      transition: width 0.4s;
    }

    @media (max-width: 600px) {
      .body-map { height: 240px; }
    }
  </style>
</head>
<body>

  <!-- Theme selector and SOS -->
  <select class="theme-picker" id="themeSelector">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="calm">Calm</option>
  </select>
  <button id="sosBtn" title="SOS / Grounding">ğŸ†˜</button>

  <div class="container">
    <h1>Grief Support Toolkit</h1>
    <p style="text-align:center; font-weight:300;">
      Supportive tools for healingâ€”mind, body, and heart.
    </p>

    <div class="grid">
      <!-- Memory Garden -->
      <div class="card">
        <h2>Memory Garden ğŸŒº</h2>
        <button onclick="plantTribute()">Add Tribute</button>
        <div id="garden"></div>
      </div>

      <!-- Body Map -->
      <div class="card">
        <h2>Grief in Your Body ğŸ—ºï¸</h2>
        <div class="body-map" id="bodyMap"></div>
      </div>

      <!-- Letters -->
      <div class="card">
        <h2>Letters to Loved Ones ğŸ’Œ</h2>
        <textarea id="loveLetter" placeholder="Write an unsent letter..."></textarea>
        <button onclick="saveLetter()">Save Letter</button>
      </div>

      <!-- Comfort Plan -->
      <div class="card">
        <h2>Comfort Plan ğŸ›¡ï¸</h2>
        <div class="plan-builder">
          <label>Who to Call</label>
          <input id="helpContact" placeholder="Name & contact details">
          <label>Soothing Activities</label>
          <textarea id="soothingActivities" placeholder="e.g., music, walk"></textarea>
          <label>Avoid List</label>
          <textarea id="avoidList" placeholder="e.g., social media"></textarea>
          <label>My Affirmations</label>
          <textarea id="affirmations" placeholder="e.g., I deserve compassion"></textarea>
          <button onclick="savePlan()">Save Plan</button>
        </div>
      </div>

      <!-- Myth Busters -->
      <div class="card">
        <h2>Myth Busters âŒ</h2>
        <div class="carousel">
          <div class="carousel-track" id="mythTrack">
            <div class="carousel-item">
              <strong>Myth:</strong> Time heals all wounds.<br>
              <em>Truth:</em> Healing requires support and time.
            </div>
            <div class="carousel-item">
              <strong>Myth:</strong> You should be over it by now.<br>
              <em>Truth:</em> Each grief journey is unique.
            </div>
            <div class="carousel-item">
              <strong>Myth:</strong> Crying is weakness.<br>
              <em>Truth:</em> Tears are healing.
            </div>
          </div>
        </div>
        <div class="carousel-controls">
          <button id="prevMyth">â€¹</button>
          <button id="nextMyth">â€º</button>
        </div>
      </div>

      <!-- Understanding Grief -->
      <div class="card">
        <h2>Understanding Grief ğŸ’¡</h2>
        <ul style="list-style:disc inside;">
          <li><a href="#" onclick="openModal('Five Stages','Denial, Anger, Bargaining, Depression, Acceptance.')">Five Stages</a></li>
          <li><a href="#" onclick="openModal('Types of Grief','Anticipatory, Complicated, Disenfranchised...')">Types</a></li>
          <li><a href="#" onclick="openModal('Grief Myths','Time heals all? Not aloneâ€”support helps.')">Myths</a></li>
        </ul>
      </div>

      <!-- Coping -->
      <div class="card">
        <h2>Coping Strategies ğŸ› ï¸</h2>
        <ul style="list-style:disc inside;">
          <li><a href="#" onclick="openModal('Breathing','Inhale 4s, hold 7s, exhale 8s.')">Breathing</a></li>
          <li><a href="#" onclick="openModal('Grounding','5-4-3-2-1 senses.')">Grounding</a></li>
          <li><a href="#" onclick="openModal('Walk','Gentle walk for 5â€“10 minutes.')">Walk</a></li>
        </ul>
      </div>

      <!-- Journal -->
      <div class="card">
        <h2>Journal Space ğŸ““</h2>
        <textarea id="journalEntry" placeholder="Write your thoughts..."></textarea>
        <button onclick="saveJournal()">Save Entry</button>
      </div>

      <!-- Mood Tracker -->
      <div class="card">
        <h2>Mood Tracker ğŸ˜Š</h2>
        <div class="mood-buttons" id="moodBtns">
          <button data-m="1" aria-checked="false">ğŸ˜</button>
          <button data-m="2" aria-checked="false">ğŸ˜Ÿ</button>
          <button data-m="3" aria-checked="false">ğŸ˜</button>
          <button data-m="4" aria-checked="false">ğŸ™‚</button>
          <button data-m="5" aria-checked="false">ğŸ˜„</button>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="moodFill"></div></div>
        <p id="moodMsg"></p>
      </div>

      <!-- Emergency & Resources -->
      <div class="card" style="flex-direction:column;align-items:center;">
        <h2>Emergency Support ğŸš¨</h2>
        <p>If in crisis, call <strong>1â€‘833â€‘456â€‘4566</strong> or 911.</p>
        <p><a href="https://www.crisisservicescanada.ca" target="_blank">Visit Crisis Services Canada</a></p>
      </div>
      <div class="card">
        <h2>Resources ğŸ“š</h2>
        <ul style="list-style:disc inside;">
          <li><a href="https://www.dougy.org" target="_blank">Dougy Center</a></li>
          <li><a href="https://www.griefshare.org" target="_blank">GriefShare</a></li>
          <li><a href="https://www.psychologytoday.com/ca" target="_blank">Therapists (Canada)</a></li>
        </ul>
      </div>

      <!-- Analytics Trigger -->
      <button id="showAnalytics" style="grid-column:1/-1;justify-self:center;">ğŸ“Š View Analytics</button>
      <div id="analyticsPanel" style="display:none; grid-column:1/-1; background:var(--card-bg); border-radius:8px; box-shadow:0 8px 20px var(--shadow); padding:1rem;">
        <h2>Analytics</h2>
        <ul id="analyticsList" style="padding-left:1.2rem;"></ul>
        <button onclick="toggleAnalytics()">Close</button>
      </div>
    </div>
  </div>

  <!-- Modal Overlay -->
  <div class="overlay" id="overlay"></div>
  <div class="modal" id="modal">
    <h3 id="modalTitle"></h3>
    <p id="modalContent"></p>
    <button class="close-btn" onclick="closeModal()">Close</button>
  </div>

  <script>
    /* â”â”â” Interactive Logic â”â”â” */
    const overlay = document.getElementById('overlay'),
          modal = document.getElementById('modal');

    window.openModal = (t,c) => {
      document.getElementById('modalTitle').innerText = t;
      document.getElementById('modalContent').innerText = c;
      overlay.style.display = modal.style.display = 'block';
      log('OpenModal ' + t);
    };

    window.closeModal = () => {
      overlay.style.display = modal.style.display = 'none';
    };

    document.getElementById('themeSelector').addEventListener('change', e => {
      document.body.className = e.target.value === 'light' ? '' : 'theme-' + e.target.value;
    });

    document.getElementById('sosBtn').addEventListener('click', () => {
      openModal('SOS / Grounding', 'Call 1â€‘833â€‘456â€‘4566 or 911. Ground with 5â€‘4â€‘3â€‘2â€‘1 senses.');
    });

    // Garden
    window.plantTribute = () => {
      const t = prompt('Enter tribute (emoji/text):');
      if (!t) return;
      const el = document.createElement('div');
      el.className = 'garden-item';
      el.textContent = t;
      document.getElementById('garden').appendChild(el);
      log('Plant ' + t);
    };

    // Body Spots
    const spots = [
      { top:'18%', left:'48%', tip:'Chest tightness â€“ try slow breathing.' },
      { top:'35%', left:'50%', tip:'Stomach ache â€“ sip warm tea.' },
      { top:'60%', left:'47%', tip:'Leg heaviness â€“ consider gentle movement.' },
    ];
    spots.forEach(s => {
      const el = document.createElement('div');
      el.className = 'body-spot';
      el.style.top = s.top;
      el.style.left = s.left;
      el.onclick = () => openModal('Physical Sign', s.tip);
      document.getElementById('bodyMap').appendChild(el);
    });

    // Save letter & plan
    window.saveLetter = () => {
      localStorage.setItem('loveLetter', document.getElementById('loveLetter').value);
      alert('Letter saved.'); log('Save Letter');
    };
    if (localStorage.getItem('loveLetter'))
      document.getElementById('loveLetter').value = localStorage.getItem('loveLetter');

    window.savePlan = () => {
      const plan = {
        call: document.getElementById('helpContact').value,
        act: document.getElementById('soothingActivities').value,
        avoid: document.getElementById('avoidList').value,
        aff: document.getElementById('affirmations').value
      };
      localStorage.setItem('comfortPlan', JSON.stringify(plan));
      alert('Plan saved.'); log('Save Plan');
    };

    // Journal
    window.saveJournal = () => {
      localStorage.setItem('journalEntry', document.getElementById('journalEntry').value);
      alert('Journal saved.'); log('Save Journal');
    };
    if (localStorage.getItem('journalEntry'))
      document.getElementById('journalEntry').value = localStorage.getItem('journalEntry');

    // Mood tracker
    const moodBtns = document.getElementById('moodBtns').children;
    const fill = document.getElementById('moodFill'),
          msg = document.getElementById('moodMsg');
    Array.from(moodBtns).forEach((b,i) => {
      b.onclick = () => {
        Array.from(moodBtns).forEach(x => x.setAttribute('aria-checked','false'));
        b.setAttribute('aria-checked','true');
        const pct = (i+1)*20;
        fill.style.width = pct+'%';
        msg.innerText = ['Very Sad','Sad','Neutral','Happy','Very Happy'][i];
        log('Mood ' + (i+1));
      };
    });

    // Myth carousel
    let idx = 0;
    const track = document.getElementById('mythTrack');
    document.getElementById('prevMyth').onclick = () => { idx = Math.max(0, idx-1); updateCarousel(); log('Myth Prev'); };
    document.getElementById('nextMyth').onclick = () => { idx = Math.min(track.children.length-1, idx+1); updateCarousel(); log('Myth Next'); };
    function updateCarousel() {
      const w = track.children[0].offsetWidth + 16;
      track.style.transform = `translateX(-${idx * w}px)`;
    }

    // Analytics
    const analytics = {};
    function log(key) { analytics[key] = (analytics[key]||0) + 1; }
    const aBtn = document.getElementById('showAnalytics'),
          aPanel = document.getElementById('analyticsPanel'),
          aList = document.getElementById('analyticsList');
    aBtn.onclick = () => {
      const keys = Object.entries(analytics);
      aList.innerHTML = keys.length ? keys.map(kv => `<li>${kv[0]}: ${kv[1]}</li>`).join('') : '<li>No interactions</li>';
      aPanel.style.display = 'block';
      aBtn.style.display = 'none';
    };
    window.toggleAnalytics = () => {
      aPanel.style.display = 'none';
      aBtn.style.display = 'block';
    };
  </script>
</body>
</html>