<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grief Support Toolkit</title>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Theme & Reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg-img: url('https://images.pexels.com/photos/7135019/pexels-photo-7135019.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260');
      --text: #333;
      --card-bg: rgba(255,255,255,0.95);
      --shadow: rgba(0,0,0,0.1);
      --primary: #7f5af0;
      --primary-light: #a865f9;
      --accent: #4b2ca9;
    }
    body {
      font-family: 'Comfortaa', cursive, sans-serif;
      color: var(--text);
      background: var(--bg-img) center/cover no-repeat fixed;
      min-height: 100vh;
    }
    h1,h2 { text-align: center; color: var(--accent); }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    button, select, textarea, input { font-family: inherit; }

    /* Layout */
    .container {
      max-width: 1100px;
      margin: 2rem auto;
      padding: 1.5rem;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 8px 30px var(--shadow);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px,1fr));
      gap: 1.5rem;
    }
    section.card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.2rem;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    section.card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px var(--shadow);
    }

    /* Controls */
    button, select {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.6rem 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover, select:hover { background: var(--primary-light); }
    button:focus, select:focus, textarea:focus, input:focus {
      outline: 2px solid var(--accent);
    }

    /* Theme toggle */
    #themeSelector {
      position: fixed; top: 1rem; left: 1rem; z-index: 100;
    }

    /* SOS */
    #sosBtn {
      position: fixed; bottom: 1rem; left: 1rem;
      background: #e03e3e; color: #fff; width: 52px; height: 52px;
      border: none; border-radius: 50%; font-size: 1.5rem;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; z-index:100;
    }
    #sosBtn:hover { background: #c13030; }

    /* Memory Garden */
    #garden { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.8rem; }
    .garden-item {
      background: var(--primary-light); color: #fff;
      padding: 0.5rem 0.8rem; border-radius: 20px;
      cursor: pointer; transition: transform 0.2s;
    }
    .garden-item:hover { transform: scale(1.1); }

    /* Body Map */
    .body-map {
      position: relative;
      background: url('https://upload.wikimedia.org/wikipedia/commons/1/17/Human_body_outline.png')
                  center/contain no-repeat;
      width: 100%; height: 350px; border-radius: 10px;
      background-color: #f9f9f9; margin-top: 1rem;
    }
    .body-spot {
      position: absolute; width: 20px; height: 20px;
      background: rgba(255,87,34,0.7);
      border: 2px solid #fff; border-radius: 50%;
      cursor: pointer; transition: transform 0.2s;
    }
    .body-spot:hover { transform: scale(1.2); }

    /* Letters */
    #loveLetter {
      width: 100%; min-height: 100px; padding: 0.8rem;
      border: 1px solid #ccc; border-radius: 8px;
      resize: vertical; margin-top: 0.5rem;
    }

    /* Comfort Plan */
    .plan-builder label { display: block; margin-top: 0.8rem; font-weight: 600; }
    .plan-builder input, .plan-builder textarea {
      width: 100%; padding: 0.6rem; border: 1px solid #ccc;
      border-radius: 6px; margin-top: 0.3rem;
    }

    /* Myth Carousel */
    .carousel { overflow: hidden; margin-top:1rem; }
    .carousel-track {
      display: flex; transition: transform 0.4s ease;
    }
    .carousel-card {
      min-width: 280px; flex-shrink: 0; margin-right: 1rem;
      background: var(--card-bg); border-radius: 8px; padding: 1rem;
      box-shadow: 0 4px 12px var(--shadow);
    }
    .carousel-controls { text-align: center; margin-top: 0.5rem; }
    .carousel-btn { margin: 0 0.3rem; }

    /* Modal */
    .overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.5);
      display: none; z-index: 500;
    }
    .modal {
      position: fixed; top:50%; left:50%;
      transform: translate(-50%,-50%);
      background: var(--card-bg); padding: 1.5rem;
      border-radius: 10px; box-shadow: 0 20px 40px var(--shadow);
      display: none; z-index: 501; max-width:90%; width:360px;
    }
    .modal h3 { margin-top: 0; color: var(--accent); }
    .modal p { margin: 0.5rem 0; line-height: 1.4; }
    .close-btn {
      margin-top: 1rem; background: #E91E63; color: #fff;
      padding: 0.5rem 1rem; border: none; border-radius: 6px;
      cursor: pointer;
    }

    textarea { margin-top: 0.5rem; }

    @media (max-width: 600px) {
      .body-map { height: 250px; }
      #themeSelector { top:0.5rem; left:0.5rem; }
      #sosBtn { bottom:0.5rem; left:0.5rem; }
    }
  </style>
</head>
<body>

  <!-- Theme & SOS -->
  <select id="themeSelector">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="calm">Calm</option>
  </select>
  <button id="sosBtn" aria-label="SOS">üÜò</button>

  <div class="container">
    <h1>Grief Support Toolkit</h1>
    <div class="grid">

      <!-- Memory Garden -->
      <section class="card">
        <h2>Memory Garden üå∫</h2>
        <button onclick="plantTribute()">Plant Tribute</button>
        <div id="garden"></div>
      </section>

      <!-- Body Map -->
      <section class="card">
        <h2>Grief in Your Body üó∫Ô∏è</h2>
        <p>Tap where you feel tension or emotion:</p>
        <div class="body-map" id="bodyMap"></div>
      </section>

      <!-- Letters -->
      <section class="card">
        <h2>Letters to Loved Ones üíå</h2>
        <textarea id="loveLetter" placeholder="Write an unsent letter..."></textarea>
        <button onclick="saveLetter()">Save Letter</button>
      </section>

      <!-- Comfort Plan -->
      <section class="card">
        <h2>Comfort Plan Builder üõ°Ô∏è</h2>
        <div class="plan-builder">
          <label for="helpContact">Who to Call</label>
          <input id="helpContact" placeholder="Name & contact"/>
          <label for="soothingActivities">Soothing Activities</label>
          <textarea id="soothingActivities" placeholder="e.g. music, walk"></textarea>
          <label for="avoidList">What to Avoid</label>
          <textarea id="avoidList" placeholder="e.g. social media"></textarea>
          <label for="affirmations">My Affirmations</label>
          <textarea id="affirmations" placeholder="e.g. I am allowed to feel"></textarea>
          <button onclick="savePlan()">Save Plan</button>
        </div>
      </section>

      <!-- Myth Busters -->
      <section class="card">
        <h2>Myth Busters ‚ùå</h2>
        <div class="carousel">
          <div class="carousel-track" id="mythTrack">
            <div class="carousel-card">
              <p><strong>Myth:</strong> Time heals all wounds.</p>
              <p><em>Truth:</em> Support & self-care are essential.</p>
            </div>
            <div class="carousel-card">
              <p><strong>Myth:</strong> You should be ‚Äúover it‚Äù by now.</p>
              <p><em>Truth:</em> Grief has its own timeline.</p>
            </div>
            <div class="carousel-card">
              <p><strong>Myth:</strong> Crying is weakness.</p>
              <p><em>Truth:</em> Tears help you heal.</p>
            </div>
          </div>
        </div>
        <div class="carousel-controls">
          <button class="carousel-btn" id="prevMyth">‚Äπ</button>
          <button class="carousel-btn" id="nextMyth">‚Ä∫</button>
        </div>
      </section>

      <!-- Understanding Grief -->
      <section class="card">
        <h2>Understanding Grief üí°</h2>
        <ul>
          <li><a href="#" onclick="openModal('Stages','Denial, Anger, Bargaining, Depression, Acceptance')">Five Stages</a></li>
          <li><a href="#" onclick="openModal('Types','Anticipatory, Complicated, Disenfranchised')">Types</a></li>
          <li><a href="#" onclick="openModal('Myths','Time heals all? Not alone‚Äîsupport helps.')">Myths</a></li>
        </ul>
      </section>

      <!-- Coping Strategies -->
      <section class="card">
        <h2>Coping Strategies üõ†Ô∏è</h2>
        <ul>
          <li><a href="#" onclick="openModal('Breathing','Inhale 4s, hold 7s, exhale 8s')">Breathing</a></li>
          <li><a href="#" onclick="openModal('Grounding','5-4-3-2-1 senses')">Grounding</a></li>
          <li><a href="#" onclick="openModal('Walk','Gentle walk to shift energy')">Walk</a></li>
        </ul>
      </section>

      <!-- Journal -->
      <section class="card">
        <h2>Journal Space üìì</h2>
        <textarea id="journalEntry" placeholder="Write your feelings..."></textarea>
        <button onclick="saveJournal()">Save Entry</button>
      </section>

      <!-- Mood Tracker -->
      <section class="card">
        <h2>Mood Tracker üòä</h2>
        <div class="mood-buttons" id="moodBtns">
          <button data-mood="1" aria-checked="false" role="radio">üòû</button>
          <button data-mood="2" aria-checked="false" role="radio">üòü</button>
          <button data-mood="3" aria-checked="false" role="radio">üòê</button>
          <button data-mood="4" aria-checked="false" role="radio">üôÇ</button>
          <button data-mood="5" aria-checked="false" role="radio">üòÑ</button>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="moodFill"></div></div>
        <p id="moodMsg"></p>
      </section>

      <!-- Emergency & Resources -->
      <section class="card">
        <h2>Emergency Support üö®</h2>
        <p>If in crisis, call <strong>1-833-456-4566</strong> or 911.</p>
        <p><a href="https://www.crisisservicescanada.ca" target="_blank">Visit Crisis Services Canada</a></p>
      </section>
      <section class="card">
        <h2>Resources üìö</h2>
        <ul>
          <li><a href="https://www.dougy.org" target="_blank">Dougy Center</a></li>
          <li><a href="https://www.griefshare.org" target="_blank">GriefShare</a></li>
          <li><a href="https://www.psychologytoday.com/ca" target="_blank">Therapists (CA)</a></li>
        </ul>
      </section>

      <!-- Analytics -->
      <button id="showAnalytics" style="grid-column:1/-1;margin:1rem auto;display:block;">üìä View Analytics</button>
      <div id="analyticsPanel" style="display:none;grid-column:1/-1;padding:1rem;background:var(--card-bg);border-radius:8px;box-shadow:0 8px 20px var(--shadow);">
        <h2 style="margin-top:0;color:var(--accent);">Analytics</h2>
        <ul id="analyticsList" style="padding-left:1.2rem;"></ul>
        <button onclick="toggleAnalytics()">Close</button>
      </div>

    </div>
  </div>

  <!-- Overlay & Modal -->
  <div class="overlay" id="overlay"></div>
  <div class="modal" id="modal">
    <h3 id="modalTitle"></h3>
    <p id="modalContent"></p>
    <button class="close-btn" onclick="closeModal()">Close</button>
  </div>

  <script>
    // Theme switch
    document.getElementById('themeSelector').addEventListener('change', e => {
      document.body.className = 'theme-' + e.target.value;
    });

    // SOS
    document.getElementById('sosBtn').addEventListener('click', ()=>{
      openModal('SOS / Grounding','Call 1-833-456-4566 or 911.<br>Ground: 5-4-3-2-1 senses.');
      log('SOS');
    });

    // Memory Garden
    window.plantTribute = ()=>{
      const t = prompt('Tribute (emoji or text):');
      if(!t) return;
      const d=document.createElement('div');
      d.className='garden-item'; d.textContent=t;
      document.getElementById('garden').appendChild(d);
      log('Plant '+t);
    };

    // Body map hotspots
    const spots=[{top:'18%',left:'48%',tip:'Chest tension: breathe slowly.'},
                 {top:'35%',left:'50%',tip:'Stomach ache: sip warm tea.'},
                 {top:'60%',left:'47%',tip:'Leg heaviness: gentle movement.'}];
    spots.forEach(s=>{
      const el=document.createElement('div');
      el.className='body-spot'; el.style.top=s.top; el.style.left=s.left;
      el.onclick=()=>{openModal('Physical Sign',s.tip); log('Body '+s.tip);};
      document.getElementById('bodyMap').appendChild(el);
    });

    // Save letter
    window.saveLetter = ()=>{
      localStorage.setItem('loveLetter',document.getElementById('loveLetter').value);
      alert('Letter saved.'); log('Letter');
    };
    if(localStorage.getItem('loveLetter'))
      document.getElementById('loveLetter').value=localStorage.getItem('loveLetter');

    // Save comfort plan
    window.savePlan = ()=>{
      const plan={
        call:document.getElementById('helpContact').value,
        act:document.getElementById('soothingActivities').value,
        avoid:document.getElementById('avoidList').value,
        aff:document.getElementById('affirmations').value
      };
      localStorage.setItem('comfortPlan',JSON.stringify(plan));
      alert('Plan saved.'); log('Plan');
    };

    // Myth carousel
    let idx=0; const track=document.getElementById('mythTrack');
    const cards=track.children.length;
    document.getElementById('prevMyth').onclick=()=>{ idx=Math.max(0,idx-1); update(); log('Myth Prev');};
    document.getElementById('nextMyth').onclick=()=>{ idx=Math.min(cards-1,idx+1); update(); log('Myth Next');};
    function update(){
      const w=track.children[0].offsetWidth+16;
      track.style.transform='translateX(-'+(idx*w)+'px)';
    }

    // Journal
    window.saveJournal=()=>{
      localStorage.setItem('journalEntry',document.getElementById('journalEntry').value);
      alert('Journal saved.'); log('Journal');
    };
    if(localStorage.getItem('journalEntry'))
      document.getElementById('journalEntry').value=localStorage.getItem('journalEntry');

    // Modals & Overlay
    const overlay=document.getElementById('overlay'), mdl=document.getElementById('modal');
    window.openModal=(t,c)=>{
      document.getElementById('modalTitle').innerText=t;
      document.getElementById('modalContent').innerHTML=c;
      overlay.style.display=mdl.style.display='block';
    };
    window.closeModal=()=>{ overlay.style.display=mdl.style.display='none'; };

    // Analytics
    const analytics={}, aBtn=document.getElementById('showAnalytics'),
          aPanel=document.getElementById('analyticsPanel'),
          aList=document.getElementById('analyticsList');
    window.log=k=>{ analytics[k]=(analytics[k]||0)+1; };
    window.toggleAnalytics=()=>{
      if(aPanel.style.display==='block'){
        aPanel.style.display='none'; aBtn.style.display='inline-block';
      } else {
        aList.innerHTML=Object.keys(analytics).length
          ?Object.entries(analytics).map(([k,v])=>`<li>${k}: ${v}</li>`).join('')
          :'<li>No interactions yet.</li>';
        aPanel.style.display='block'; aBtn.style.display='none';
      }
    };
  </script>
</body>
</html>